"use strict";(self["webpackChunkcrystal_dapp"]=self["webpackChunkcrystal_dapp"]||[]).push([[449],{25192:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ne});var n=a(59835),o=a(86970);const l={class:"q-pa-md",style:{width:"100%","max-width":"1439px"}},s=(0,n._)("br",null,null,-1),r={class:"q-pa-md col-3 col-md-4 col-sm-6 col-xs-12"},i={class:"q-gutter-x-sm",style:{"z-index":"2"}},c=["src"],u={class:"q-gutter-x-sm",style:{"z-index":"1",position:"absolute",top:"0px",left:"0px"}},d=["src"],m=["href"],w={class:"cursor-pointer"},p=(0,n.Uk)(" House Edge "),f=(0,n.Uk)("PLAY"),h=(0,n.Uk)("INVEST"),v=(0,n._)("span",{class:"text-h6 q-ml-sm"},"Incorrect blockchain",-1),g=(0,n._)("span",{class:"q-ml-sm"},"You are currently not connected to the correct network.",-1);function k(e,t,a,k,_,y){const W=(0,n.up)("q-icon"),x=(0,n.up)("q-btn"),q=(0,n.up)("q-page-sticky"),b=(0,n.up)("q-avatar"),Z=(0,n.up)("q-item-section"),I=(0,n.up)("q-item-label"),C=(0,n.up)("q-item"),Q=(0,n.up)("q-chip"),N=(0,n.up)("q-card-section"),S=(0,n.up)("q-separator"),A=(0,n.up)("q-btn-group"),H=(0,n.up)("q-card-actions"),z=(0,n.up)("q-card"),U=(0,n.up)("q-space"),E=(0,n.up)("q-dialog"),P=(0,n.up)("BalanceView"),B=(0,n.up)("q-page"),V=(0,n.Q2)("close-popup");return(0,n.wg)(),(0,n.j4)(B,{class:"row justify-evenly"},{default:(0,n.w5)((()=>[(0,n.Wm)(q,{position:"top-left",offset:[0,0],style:{"z-index":"999"}},{default:(0,n.w5)((()=>[(0,n.Wm)(x,{flat:"","no-caps":"",to:"/"},{default:(0,n.w5)((()=>[(0,n.Wm)(W,{name:"las la-angle-double-left"})])),_:1}),(0,n.Wm)(x,{flat:"","no-caps":"",onClick:e.refresh},{default:(0,n.w5)((()=>[(0,n.Wm)(W,{name:"las la-sync"})])),_:1},8,["onClick"])])),_:1}),(0,n._)("div",l,[s,(0,n._)("div",r,[(0,n.Wm)(z,{class:"my-card"},{default:(0,n.w5)((()=>[(0,n.Wm)(N,{class:"bg-primary text-white"},{default:(0,n.w5)((()=>[(0,n.Wm)(C,null,{default:(0,n.w5)((()=>[(0,n.Wm)(Z,{avatar:""},{default:(0,n.w5)((()=>[(0,n._)("div",i,[(0,n.Wm)(b,{size:"48px"},{default:(0,n.w5)((()=>[(0,n._)("img",{src:"tokens/"+e.token+".png"},null,8,c)])),_:1})]),(0,n._)("div",u,[(0,n.Wm)(b,{size:"30px",color:"white"},{default:(0,n.w5)((()=>[(0,n._)("img",{src:"chains/"+e.networkName+".svg",style:{width:"60%"}},null,8,d)])),_:1})])])),_:1}),(0,n.Wm)(Z,null,{default:(0,n.w5)((()=>[(0,n.Wm)(I,{class:"text-h6"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(e.gameName),1)])),_:1}),(0,n.Wm)(I,{caption:""},{default:(0,n.w5)((()=>[(0,n.Wm)(x,{size:"10px",flat:"",dense:"",icon:"open_in_new"},{default:(0,n.w5)((()=>[(0,n._)("a",{href:e.linkAddress(e.contract,e.network),target:"_blank",class:"text-white"},[(0,n._)("span",w,(0,o.zw)(e.shortAddress(e.contract)),1)],8,m)])),_:1})])),_:1})])),_:1})])),_:1}),(0,n.Wm)(C,null,{default:(0,n.w5)((()=>[(0,n._)("div",null,[(0,n.Wm)(Q,null,{default:(0,n.w5)((()=>[(0,n.Wm)(b,{color:"red","text-color":"white"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(e.houseEdge+"%"),1)])),_:1}),p])),_:1}),(0,n.Wm)(Q,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Rake "+(0,o.zw)(e.rake+"%"),1)])),_:1})])])),_:1})])),_:1}),(0,n.Wm)(S),(0,n.Wm)(H,{class:"row",align:"around"},{default:(0,n.w5)((()=>[(0,n.Wm)(A,{push:"",spread:"",class:"full-width"},{default:(0,n.w5)((()=>[(0,n.Wm)(x,{color:"yellow",class:"col-5 text-black"},{default:(0,n.w5)((()=>[f])),_:1}),(0,n.Wm)(x,{color:"orange",class:"col-5 text-black"},{default:(0,n.w5)((()=>[h])),_:1})])),_:1})])),_:1})])),_:1})]),(0,n.Wm)(E,{modelValue:e.switchNet,"onUpdate:modelValue":t[0]||(t[0]=t=>e.switchNet=t),persistent:""},{default:(0,n.w5)((()=>[(0,n.Wm)(z,null,{default:(0,n.w5)((()=>[(0,n.Wm)(N,{class:"row items-center q-pb-none"},{default:(0,n.w5)((()=>[(0,n.Wm)(b,{icon:"signal_wifi_off",color:"primary","text-color":"white",size:"xs"}),v,(0,n.Wm)(U),(0,n.wy)((0,n.Wm)(x,{icon:"close",flat:"",round:"",dense:""},null,512),[[V]])])),_:1}),(0,n.Wm)(N,{class:"row items-center"},{default:(0,n.w5)((()=>[g])),_:1}),(0,n.Wm)(H,{align:"right"},{default:(0,n.w5)((()=>[(0,n.wy)((0,n.Wm)(x,{class:"full-width",label:"Switch",color:"primary",onClick:e.switchNetwork},null,8,["onClick"]),[[V]])])),_:1})])),_:1})])),_:1},8,["modelValue"])]),(0,n.Wm)(P)])),_:1})}var _=a(60499),y=a(85990),W=a(19302),x=a(65457),q=a(18910),b=a(28488),Z=a(37948),I=a(17779),C=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,l){function s(e){try{i(n.next(e))}catch(t){l(t)}}function r(e){try{i(n["throw"](e))}catch(t){l(t)}}function i(e){e.done?a(e.value):o(e.value).then(s,r)}i((n=n.apply(e,t||[])).next())}))};const Q=a(57841),N={title:"Crystal - Invest"};function S(e){I.log("Switch network: ",(0,y.v)().networks[e].name,(0,y.v)().networks[e].id),(0,y.v)().initWeb3(e)}const A=(0,n.aZ)({name:"InvestPage",components:{BalanceView:Z.Z},setup(){const e=(0,q.yj)(),t=(0,W.Z)();t.dark.set(!0),(0,x.Z)(N);const a=(0,_.iH)(256e5),n=(0,_.iH)(0),o=(0,_.iH)(""),l=(0,_.iH)(""),s=(0,_.iH)(""),r=(0,_.iH)(""),i=(0,_.iH)(0),c=(0,_.iH)(0),u=(0,_.iH)(!1),d=(0,y.v)();function m(){return C(this,void 0,void 0,(function*(){const e=yield(0,y.v)().web3.eth.net.getId().then((e=>(I.log(e),e))).catch((e=>(I.log("checkNetwork: ",e),-1)));return e}))}function w(){return C(this,void 0,void 0,(function*(){const e=(0,y.v)().networks[n.value].id,t=(0,y.v)().networks[n.value].name,a=(0,y.v)().networks[n.value].tokenName,o=(0,y.v)().networks[n.value].symbol,l=(0,y.v)().networks[n.value].rpcUrl,s=(0,y.v)().networks[n.value].explorer,r="0x"+e.toString(16);if("undefined"!==typeof window.ethereum)try{yield window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:r}]}),location.reload()}catch(i){if(I.log(i),4902===i.code){I.log("Add Chain");try{yield window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:r,chainName:t,nativeCurrency:{name:a,symbol:o,decimals:18},rpcUrls:[l],blockExplorerUrls:[s]}]}),location.reload()}catch(c){alert(c.message)}}else alert(i.message)}}))}function p(e,t){return C(this,void 0,void 0,(function*(){if(!(0,y.v)().web3.utils.isAddress((0,y.v)().accountAddr))return void alert("Need Connect Wallet!");const a=yield m();if(a!=(0,y.v)().networks[n.value].id)return I.log(a,"!=",(0,y.v)().networks[n.value].id),void(u.value=!0);const o=(0,y.v)().web3,l=new o.eth.Contract(Q,t);I.log("Invest(",t,",",e,")");let s=l.methods.invest(),r=s.encodeABI();o.eth.estimateGas({from:(0,y.v)().account,to:t,value:o.utils.toWei(e.toString(),"ether"),data:r}).then((function(a){I.log("gasAmount: ",a),o.eth.sendTransaction({from:(0,y.v)().account,to:t,value:o.utils.toWei(e.toString(),"ether"),gas:parseInt((1.05*a).toString()),gasPrice:36e9,data:r}).on("transactionHash",(e=>{I.log("transactionHash: ",e)})).on("receipt",(e=>{I.log("receipt: ",e)})).on("error",(e=>{I.log("tx placeBet ",e)}))})).catch((function(e){I.log("estimateGas: ",e);let t=e.message.toString(),a=t.split(".")[1],n=JSON.parse(a),o=n.message.split(":");alert(o[0]+": "+o[1])}))}))}return{shortAddress:b.sC,copyAddress:b.c4,linkAddress:b.ol,store:d,network:n,networkName:o,switchNet:u,fromBlock:a,gameName:l,contract:s,token:r,houseEdge:i,rake:c,refresh(){I.log("Refresh"),location.reload()},initInvest(){let t=0;null!=e.query.game?t=parseInt(e.query.game.toString()):I.log("Default game");let a=d.gameList[t];l.value=a.name,n.value=a.networkId,o.value=(0,y.v)().networks[a.networkId].name.toLowerCase(),s.value=a.contract,r.value=a.token,i.value=a.houseEdge,c.value=a.rake,I.log("Init Invest: ",t),S(a.networkId)},checkNetwork:m,switchNetwork:w,investTx:p}},beforeMount(){this.initInvest()}});var H=a(11639),z=a(69885),U=a(3388),E=a(68879),P=a(22857),B=a(44458),V=a(63190),T=a(490),L=a(76749),j=a(61357),G=a(33115),D=a(57691),R=a(50926),Y=a(11821),F=a(67236),J=a(32074),M=a(90136),O=a(18149),K=a(84106),X=a(68989),$=a(62146),ee=a(69984),te=a.n(ee);const ae=(0,H.Z)(A,[["render",k]]),ne=ae;te()(A,"components",{QPage:z.Z,QPageSticky:U.Z,QBtn:E.Z,QIcon:P.Z,QCard:B.Z,QCardSection:V.Z,QItem:T.Z,QItemSection:L.Z,QAvatar:j.Z,QItemLabel:G.Z,QChip:D.Z,QSeparator:R.Z,QCardActions:Y.Z,QBtnGroup:F.Z,QDialog:J.Z,QSpace:M.Z,QField:O.Z,QTabPanel:K.Z,QTable:X.Z}),te()(A,"directives",{ClosePopup:$.Z})}}]);