"use strict";(self["webpackChunkcrystal_dapp"]=self["webpackChunkcrystal_dapp"]||[]).push([[696],{5193:(e,t,n)=>{n.r(t),n.d(t,{default:()=>vt});var l=n(59835),a=n(86970);const s=e=>((0,l.dD)("data-v-4eef94d6"),e=e(),(0,l.Cn)(),e),o={class:"q-pa-md",style:{"max-width":"1439px"}},i={class:"row q-pa-none"},r=["onClick"],c={class:"gem-count text-right text-bold"},u=s((()=>(0,l._)("i",{class:"mdi-blank"},null,-1))),m=s((()=>(0,l._)("i",{class:"mdi-blank"},null,-1))),d={class:"gem-box row items-center justify-evenly"},f={key:1,class:"nft-id"},v=s((()=>(0,l._)("i",{class:"las la-angle-down inline",sixe:"xs"},null,-1))),p=[v],y=s((()=>(0,l._)("div",{class:"text-h6"},[(0,l._)("i",{class:"las la-plus"})],-1))),g={class:"gem-box row items-center justify-evenly"},w={key:1,class:"nft-id"},h=s((()=>(0,l._)("i",{class:"las la-angle-down",sixe:"xs"},null,-1))),b=[h],x=s((()=>(0,l._)("i",{class:"mdi-blank"},null,-1))),_=s((()=>(0,l._)("i",{class:"mdi-blank"},null,-1))),k=s((()=>(0,l._)("div",{class:"text-center"},[(0,l._)("i",{class:"las la-angle-double-down"})],-1))),G={class:"gem-box row items-center justify-evenly"},q={key:0,class:"info",style:{"text-shadow":"#000 1px 0 10px",position:"absolute",transform:"translate(0%, -50%)",top:"50%",right:"50%","padding-right":"35px"}},C={key:1,class:"info",style:{"text-shadow":"#000 1px 0 10px",position:"absolute",transform:"translate(0%, -50%)",top:"50%",left:"50%","padding-left":"35px"}},I={class:""},T={class:"gem-level q-pr-sm"},W={class:"q-pr-sm text-h6"},S={class:"gem-quality text-caption text-grey text-center"},z=s((()=>(0,l._)("div",{class:"text-center"},null,-1))),D={class:"row items-center justify-evenly"},N=s((()=>(0,l._)("div",{class:"text-h6"},[(0,l._)("i",{class:"las la-plus"})],-1))),H=s((()=>(0,l._)("div",{class:"text-h6"},[(0,l._)("i",{class:"las la-angle-double-right"})],-1))),R={key:0},A={key:1,class:"text-h6"},L=s((()=>(0,l._)("i",{class:"las la-question"},null,-1))),U=[L],Z=s((()=>(0,l._)("span",{class:"text-h6 q-ml-sm"},"Incorrect blockchain",-1))),$=s((()=>(0,l._)("span",{class:"q-ml-sm"},"You are currently not connected to the correct network.",-1))),E={class:"info row",style:{"text-shadow":"#000 1px 0 10px"}},j={class:"text-h6"},Q={key:0,class:"gem-box row items-center justify-evenly"},M={class:"nft-id-2"},O=["onClick"],V=s((()=>(0,l._)("i",{class:"las la-plus"},null,-1))),P=[V],F=s((()=>(0,l._)("br",null,null,-1))),J=(0,l.Uk)(" Choose a Target "),B=["onClick"],K={class:"gem-count text-right text-bold"},Y=s((()=>(0,l._)("span",{class:"text-h6 q-ml-sm"},"Combine Gem",-1))),X={class:"q-pa-xs"},ee={key:0,class:"text-left"},te=s((()=>(0,l._)("a",null,[(0,l._)("span",{class:"cursor-pointer"}," Sign transaction with your wallet and we will never touch your private key! ")],-1))),ne=[te],le={key:1,class:"text-left text-red"},ae=["href"],se={class:"cursor-pointer"},oe=s((()=>(0,l._)("a",null,[(0,l._)("span",{class:"cursor-pointer"}," Transaction is broadcasted, waiting for confirmation. ")],-1))),ie={class:"row"},re=s((()=>(0,l._)("div",{class:"gem-frame row items-center justify-evenly col"},[(0,l._)("div",{class:"text-h3"},"?")],-1))),ce={class:"gem-info",style:{"text-shadow":"#000 1px 0 10px"}},ue={class:"text-h6 gem-name"},me={class:"text-subtitle1"},de={class:"gem-level"},fe={class:"gem-scale"},ve={class:"gem-quality"},pe=s((()=>(0,l._)("br",null,null,-1))),ye={class:"cursor-pointer"},ge={class:"row"},we={class:"gem-frame row items-center justify-evenly col"},he={class:"gem-info",style:{"text-shadow":"#000 1px 0 10px"}},be={class:"gem-level"},xe={class:"gem-scale"},_e={class:"gem-quality"},ke={class:"gem-quality text-caption text-grey",style:{"max-width":"200px"}},Ge=s((()=>(0,l._)("br",null,null,-1))),qe=s((()=>(0,l._)("span",{class:"text-subtitle2 text-secondary q-ml-sm"},"https://crystal.network",-1)));function Ce(e,t,n,s,v,h){const L=(0,l.up)("CrystalGem"),V=(0,l.up)("q-card-section"),te=(0,l.up)("q-btn"),Ce=(0,l.up)("q-item-label"),Ie=(0,l.up)("q-item-section"),Te=(0,l.up)("q-item"),We=(0,l.up)("q-list"),Se=(0,l.up)("q-tab-panel"),ze=(0,l.up)("q-tab-panels"),De=(0,l.up)("nft-menu"),Ne=(0,l.up)("q-avatar"),He=(0,l.up)("q-space"),Re=(0,l.up)("q-card-actions"),Ae=(0,l.up)("q-card"),Le=(0,l.up)("q-dialog"),Ue=(0,l.up)("q-step"),Ze=(0,l.up)("q-linear-progress"),$e=(0,l.up)("q-chip"),Ee=(0,l.up)("q-stepper"),je=(0,l.up)("q-page"),Qe=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.j4)(je,{class:"row justify-evenly bg-pic",style:{"padding-top":"58px"}},{default:(0,l.w5)((()=>[(0,l._)("div",o,[(0,l.Wm)(ze,{class:"",flat:"","model-value":"crafting",animated:""},{default:(0,l.w5)((()=>[(0,l.Wm)(Se,{class:"items-center q-pa-xs",name:"crafting"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{class:"row items-center justify-evenly"},{default:(0,l.w5)((()=>[(0,l._)("div",i,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.canCombineGems,(t=>((0,l.wg)(),(0,l.iD)("div",{key:t},[(0,l._)("div",{class:"gem-box row items-center justify-evenly",onClick:n=>e.setToCombine(t,0)},[(0,l.Wm)(L,{nft:0,level:t.level,color:t.color,quality:100,scale:.64,size:50},null,8,["level","color","scale"])],8,r),(0,l._)("div",c," x "+(0,a.zw)(t.text),1)])))),128))])])),_:1}),(0,l.Wm)(V,{class:"row items-center justify-evenly"},{default:(0,l.w5)((()=>[u,m,(0,l._)("div",d,[e.fromGem1?((0,l.wg)(),(0,l.iD)("div",{key:e.fromGem1},[(0,l.Wm)(L,{nft:e.fromGem1.nft,level:e.fromGem1.level,color:e.fromGem1.color,quality:e.fromGem1.quality,scale:e.fromGem1.scale,size:50,detail:!0},null,8,["nft","level","color","quality","scale"])])):(0,l.kq)("",!0),e.fromGem1?((0,l.wg)(),(0,l.iD)("div",f,"#"+(0,a.zw)(e.fromGem1.nft),1)):(0,l.kq)("",!0),e.fromGem1&&e.fromGems.length>2?((0,l.wg)(),(0,l.iD)("div",{key:2,class:"choose-from-gem text-center no-padding",onClick:t[0]||(t[0]=t=>{e.chooseFrom=!0,e.chooseNum=1})},p)):(0,l.kq)("",!0)]),y,(0,l._)("div",g,[e.fromGem2?((0,l.wg)(),(0,l.iD)("div",{key:e.fromGem2},[(0,l.Wm)(L,{nft:e.fromGem2.nft,level:e.fromGem2.level,color:e.fromGem2.color,quality:e.fromGem2.quality,scale:e.fromGem2.scale,size:50,detail:!0},null,8,["nft","level","color","quality","scale"])])):(0,l.kq)("",!0),e.fromGem2?((0,l.wg)(),(0,l.iD)("div",w,"#"+(0,a.zw)(e.fromGem2.nft),1)):(0,l.kq)("",!0),e.fromGem2&&e.fromGems.length>2?((0,l.wg)(),(0,l.iD)("div",{key:2,class:"choose-from-gem text-center",onClick:t[1]||(t[1]=t=>{e.chooseFrom=!0,e.chooseNum=2})},b)):(0,l.kq)("",!0)]),x,_])),_:1}),k,(0,l.Wm)(V,{class:"row items-center justify-evenly"},{default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l._)("div",G,[e.toCombineGem?((0,l.wg)(),(0,l.j4)(L,{key:e.toCombineGem,nft:0,level:e.toCombineGem.level,color:e.toCombineGem.color,quality:100,scale:.8,size:50},null,8,["level","color","scale"])):(0,l.kq)("",!0)]),e.toCombineGem?((0,l.wg)(),(0,l.iD)("div",q,[(0,l._)("div",{class:(0,a.C_)(e.getRarity(e.toCombineGem.level).rarity+" text-h6 text-right")},(0,a.zw)(e.$t("gems.levels."+e.toCombineGem.level)+e.$t("gems.names."+e.toCombineGem.color)),3),(0,l._)("div",{class:(0,a.C_)(e.getRarity(e.toCombineGem.level).rarity+" text-right")},(0,a.zw)(e.$t("gems."+e.getRarity(e.toCombineGem.level).rarity)+" "+e.$t("gems.gem")),3)])):(0,l.kq)("",!0),e.toCombineGem?((0,l.wg)(),(0,l.iD)("div",C,[(0,l._)("div",I,[(0,l._)("div",T,(0,a.zw)(e.$t("crafting.successRate")+":"),1),(0,l._)("div",W,(0,a.zw)(Math.floor(((e.fromGem1?e.fromGem1.quality:0)+(e.fromGem2?e.fromGem2.quality:0))/2))+".00 % ",1)])])):(0,l.kq)("",!0)])])),_:1}),(0,l._)("div",S,(0,a.zw)(e.$t("crafting.successInfo")),1),z,(0,l.Wm)(V,null,{default:(0,l.w5)((()=>[(0,l.Wm)(te,{unelevated:"",color:"primary",class:"min-width-320 full-width","no-caps":"",onClick:t[2]||(t[2]=t=>e.combineClicked())},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)(e.$t("crafting.combine")),1)])),_:1})])),_:1}),(0,l.Wm)(V,null,{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.combineEvents,((t,n,s)=>((0,l.wg)(),(0,l.j4)(We,{dense:"",class:"reverse",key:t},{default:(0,l.w5)((()=>[s==Object.keys(e.combineEvents).length-1?((0,l.wg)(),(0,l.j4)(Te,{key:0},{default:(0,l.w5)((()=>[(0,l.Wm)(Ie,null,{default:(0,l.w5)((()=>[(0,l._)("div",D,[(0,l.Wm)(L,{nft:0,level:t.fromLevel,color:t.color,quality:100,scale:.5,size:40},null,8,["level","color","scale"]),N,(0,l.Wm)(L,{nft:0,level:t.fromLevel,color:t.color,quality:100,scale:.5,size:40},null,8,["level","color","scale"]),H,t.toLevel>=0?((0,l.wg)(),(0,l.iD)("div",R,[(0,l.Wm)(L,{nft:t.gemId,level:t.toLevel,color:t.color,quality:e.uriToNum(t.uri).quality,scale:e.uriToNum(t.uri).scale,size:40,detail:!0},null,8,["nft","level","color","quality","scale"])])):((0,l.wg)(),(0,l.iD)("div",A,U))]),(0,l.Wm)(Ce,{class:"text-center"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,a.zw)("#"+t.from1+" + #"+t.from2)+" => #"+(0,a.zw)(n),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)):(0,l.kq)("",!0)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})]),(0,l.Wm)(De),(0,l.Wm)(Le,{modelValue:e.switchNet,"onUpdate:modelValue":t[4]||(t[4]=t=>e.switchNet=t),persistent:""},{default:(0,l.w5)((()=>[(0,l.Wm)(Ae,{class:"bg-glass"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{class:"row items-center q-pb-none"},{default:(0,l.w5)((()=>[(0,l.Wm)(Ne,{icon:"signal_wifi_off",color:"primary","text-color":"white",size:"xs"}),Z,(0,l.Wm)(He),(0,l.wy)((0,l.Wm)(te,{icon:"close",flat:"",round:"",dense:""},null,512),[[Qe]])])),_:1}),(0,l.Wm)(V,{class:"row items-center"},{default:(0,l.w5)((()=>[$])),_:1}),(0,l.Wm)(Re,{align:"right"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(te,{class:"full-width",label:"Switch",color:"primary",onClick:t[3]||(t[3]=t=>e.switchNetwork(e.netIndex))},null,512),[[Qe]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(Le,{modelValue:e.chooseFrom,"onUpdate:modelValue":t[5]||(t[5]=t=>e.chooseFrom=t)},{default:(0,l.w5)((()=>[(0,l.Wm)(Ae,{class:"bg-glass min-width-320"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{class:"row items-center q-pb-none"},{default:(0,l.w5)((()=>[(0,l._)("div",E,[(0,l._)("div",j,(0,a.zw)(e.$t("crafting.chooseA"))+"Â ",1),(0,l._)("div",{class:(0,a.C_)(e.getRarity(e.fromGems[0].level).rarity+" text-h6")}," ["+(0,a.zw)(e.$t("gems.levels."+e.fromGems[0].level)+e.$t("gems.names."+e.fromGems[0].color))+"] ",3)])])),_:1}),(0,l.Wm)(V,{class:"row items-center q-pb-none"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.fromGems,(t=>((0,l.wg)(),(0,l.iD)("div",{class:"row",key:t},[t.nft!=e.fromGem1.nft&&t.nft!=e.fromGem2.nft?((0,l.wg)(),(0,l.iD)("div",Q,[(0,l._)("div",null,[(0,l.Wm)(L,{nft:t.nft,level:t.level,color:t.color,quality:t.quality,scale:t.scale,size:50,detail:!0},null,8,["nft","level","color","quality","scale"])]),(0,l._)("div",M,"#"+(0,a.zw)(t.nft),1),(0,l._)("div",{class:"choose-from-gem text-center",onClick:n=>e.setToCombine(t,e.chooseNum)},P,8,O)])):(0,l.kq)("",!0)])))),128))])),_:1}),(0,l.Wm)(V,{class:"row items-center q-pb-none"},{default:(0,l.w5)((()=>[F])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(Le,{modelValue:e.chooseTar,"onUpdate:modelValue":t[6]||(t[6]=t=>e.chooseTar=t)},{default:(0,l.w5)((()=>[(0,l.Wm)(Ae,{class:"bg-glass min-width-320"},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{class:"row items-center q-pb-none"},{default:(0,l.w5)((()=>[J])),_:1}),(0,l.Wm)(V,{class:"row items-center q-pb-none"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.canCombineGems,(t=>((0,l.wg)(),(0,l.iD)("div",{key:t},[(0,l._)("div",{class:"gem-box row items-center justify-evenly",onClick:n=>e.setToCombine(t,0)},[(0,l.Wm)(L,{nft:0,level:t.level,color:t.color,quality:100,scale:.64,size:45},null,8,["level","color","scale"])],8,B),(0,l._)("div",K,"x "+(0,a.zw)(t.text),1)])))),128))])),_:1}),(0,l.Wm)(V,{class:"row items-center q-pb-none"})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(Le,{modelValue:e.signTx,"onUpdate:modelValue":t[9]||(t[9]=t=>e.signTx=t),position:"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(Ae,{style:{top:"50px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(V,{class:"q-pa-xs row items-center q-pb-none"},{default:(0,l.w5)((()=>[Y,(0,l.Wm)(He),(0,l.wy)((0,l.Wm)(te,{icon:"close",flat:"",round:"",dense:""},null,512),[[Qe]])])),_:1}),(0,l.Wm)(V,{class:"row items-center q-pa-xs"},{default:(0,l.w5)((()=>[(0,l._)("div",X,[(0,l.Wm)(Ee,{modelValue:e.txStep,"onUpdate:modelValue":t[8]||(t[8]=t=>e.txStep=t),vertical:"",color:"primary",flat:"",animated:""},{default:(0,l.w5)((()=>[(0,l.Wm)(Ue,{name:1,title:"Sign Transaction",icon:"las la-wallet",done:e.txStep>1,error:e.signTxErr.length>0},{default:(0,l.w5)((()=>[""==e.signTxErr?((0,l.wg)(),(0,l.iD)("div",ee,ne)):((0,l.wg)(),(0,l.iD)("div",le,(0,a.zw)(e.signTxErr),1))])),_:1},8,["done","error"]),(0,l.Wm)(Ue,{name:2,title:"Send Transaction",icon:"las la-receipt",done:e.txStep>2},{default:(0,l.w5)((()=>[(0,l._)("a",{href:e.linkAddress(e.signTxHash,e.netIndex,"tx"),target:"_blank",class:"text-grey-6"},[(0,l._)("span",se,(0,a.zw)(" tx hash: "+e.shortAddress(e.signTxHash,6,!1)),1)],8,ae),oe,(0,l.Wm)(Ze,{dark:"",rounded:"",indeterminate:"",color:"secondary",class:"q-mt-sm"})])),_:1},8,["done"]),(0,l.Wm)(Ue,{name:3,title:"Waiting for Result",icon:"las la-hourglass-half",done:e.txStep>3},{default:(0,l.w5)((()=>[(0,l._)("div",ie,[re,(0,l._)("div",ce,[(0,l._)("div",ue,[(0,l.Uk)((0,a.zw)(e.$t("airdrop.gotGemNft")+":")+" ",1),(0,l._)("span",me,"#"+(0,a.zw)(e.txGem),1)]),(0,l._)("div",de,(0,a.zw)(e.$t("gems.level")+":")+" ??? ",1),(0,l._)("div",fe,(0,a.zw)(e.$t("gems.weight")+":")+" ??? ",1),(0,l._)("div",ve,(0,a.zw)(e.$t("gems.quality")+":")+" ??? ",1)])]),(0,l.Wm)(Ze,{dark:"",rounded:"",indeterminate:"",color:"secondary",class:"q-mt-sm"}),pe,(0,l._)("a",null,[(0,l._)("span",ye,(0,a.zw)(e.$t("airdrop.whenAppear")),1)])])),_:1},8,["done"]),(0,l.Wm)(Ue,{name:4,done:4==e.txStep,title:"Result",icon:"las la-trophy"},{default:(0,l.w5)((()=>[(0,l._)("div",ge,[(0,l._)("div",we,[(0,l.Wm)(L,{nft:e.txGemDetail.nft,level:e.txGemDetail.level,color:e.txGemDetail.color,quality:e.txGemDetail.quality,scale:e.txGemDetail.scale,size:50},null,8,["nft","level","color","quality","scale"])]),(0,l._)("div",he,[(0,l._)("div",{class:(0,a.C_)(e.getRarity(e.txGemDetail.level).rarity+" text-h6")},(0,a.zw)(e.$t("gems.levels."+e.txGemDetail.level)+e.$t("gems.names."+e.txGemDetail.color)),3),(0,l._)("div",{class:(0,a.C_)(e.getRarity(e.txGemDetail.level).rarity)},[(0,l.Uk)((0,a.zw)(e.$t("gems."+e.getRarity(e.txGemDetail.level).rarity)+" "+e.$t("gems.gem"))+" ",1),(0,l.Wm)($e,{dense:"",color:"grey"},{default:(0,l.w5)((()=>[(0,l._)("a",{class:(0,a.C_)(e.getRarity(e.txGemDetail.level).rarity)},(0,a.zw)(e.getRarity(e.txGemDetail.level).short),3)])),_:1})],2),(0,l._)("div",be,(0,a.zw)(e.$t("gems.level")+": "+4*parseInt(e.txGemDetail.level)+10),1),(0,l._)("div",xe,(0,a.zw)(e.$t("gems.weight")+": "+parseInt(100*e.txGemDetail.scale)),1),(0,l._)("div",_e,(0,a.zw)(e.$t("gems.quality")+": "+e.txGemDetail.quality),1),(0,l._)("div",ke,(0,a.zw)(e.$t("gems.qualityInfo")),1)])]),Ge,(0,l.Wm)(te,{onClick:t[7]||(t[7]=t=>e.signTx=!1),color:"primary",label:"OK",class:"q-ml-sm full-width",dense:""})])),_:1},8,["done"])])),_:1},8,["modelValue"])])])),_:1}),(0,l.Wm)(V,{class:"q-pa-xs row items-center q-pb-none"},{default:(0,l.w5)((()=>[qe])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}var Ie=n(60499),Te=n(19302),We=n(65457),Se=n(7054),ze=n(82108),De=n(85990),Ne=n(28488),He=n(88576),Re=n.n(He),Ae=n(17779),Le=function(e,t,n,l){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function o(e){try{r(l.next(e))}catch(t){s(t)}}function i(e){try{r(l["throw"](e))}catch(t){s(t)}}function r(e){e.done?n(e.value):a(e.value).then(o,i)}r((l=l.apply(e,t||[])).next())}))},Ue=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"===typeof __values?__values(e):e[Symbol.iterator](),t={},l("next"),l("throw"),l("return"),t[Symbol.asyncIterator]=function(){return this},t);function l(n){t[n]=e[n]&&function(t){return new Promise((function(l,s){t=e[n](t),a(l,s,t.done,t.value)}))}}function a(e,t,n,l){Promise.resolve(l).then((function(t){e({value:t,done:n})}),t)}};const Ze=n(10875),$e=n(72593);function Ee(e){Ae.log("Switch network: ",(0,De.v)().networks[e].name,(0,De.v)().networks[e].id),(0,De.v)().initWeb3(e)}const je={title:"Crystal - Crafting"},Qe=(0,l.aZ)({name:"CraftingPage",components:{NftMenu:Se.Z,CrystalGem:ze.Z},setup(){const e=(0,Te.Z)();e.dark.set(!0),(0,We.Z)(je);const t=(0,Ie.iH)({}),n=(0,Ie.iH)(0),l=(0,Ie.iH)([]),a=(0,Ie.iH)([]),s=(0,Ie.iH)([]),o=(0,Ie.iH)([]),i=(0,Ie.iH)(),r=(0,Ie.iH)(),c=(0,Ie.iH)(),u=(0,Ie.iH)(!1),m=(0,Ie.iH)(""),d=(0,Ie.iH)(""),f=(0,Ie.iH)(1),v=(0,Ie.iH)(0),p=(0,Ie.iH)();let y=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],g=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];const w=e=>new Promise((t=>setTimeout(t,e))),h=(0,Ie.iH)(!1),b=(0,Ie.iH)(!1),x=(0,Ie.iH)(!1),_=(0,Ie.iH)(0),k="polygon",G=(0,Ie.iH)(0),q=(0,Ie.iH)("0x5b0b56a94BA3F1e417B70b2484CeF43102685385"),C=(0,Ie.iH)("0x30a8C517b35e7D635f77AaeeBb0C704015dFaa6A");function I(){return Le(this,void 0,void 0,(function*(){const e=yield(0,De.v)().web3.eth.net.getId().then((e=>e)).catch((e=>(Ae.log("checkNetwork: ",e),-1)));return e}))}function T(e){return Le(this,void 0,void 0,(function*(){const t=(0,De.v)().networks[e].id,n=(0,De.v)().networks[e].name,l=(0,De.v)().networks[e].tokenName,a=(0,De.v)().networks[e].symbol,s=(0,De.v)().networks[e].rpcUrl,o=(0,De.v)().networks[e].explorer,i="0x"+t.toString(16);if("undefined"!==typeof window.ethereum)try{yield window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:i}]}),location.reload()}catch(r){if(Ae.log(r),4902===r.code){Ae.log("Add Chain");try{yield window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:i,chainName:n,nativeCurrency:{name:l,symbol:a,decimals:18},rpcUrls:[s],blockExplorerUrls:[o]}]}),location.reload()}catch(c){alert(c.message)}}else alert(r.message)}}))}function W(e){return Le(this,void 0,void 0,(function*(){const t=yield Re().Web3API.token.reSyncMetadata({chain:k,address:C.value,token_id:e,flag:"uri"});Ae.log("reSyncURI resp:",e,t)}))}function S(e){var t,n,l,a;return Le(this,void 0,void 0,(function*(){try{for(t=Ue(e);n=yield t.next(),!n.done;){const e=n.value;yield w(1e3),yield W(e),yield z(e)}}catch(s){l={error:s}}finally{try{n&&!n.done&&(a=t.return)&&(yield a.call(t))}finally{if(l)throw l.error}}}))}function z(e){return Le(this,void 0,void 0,(function*(){Ae.log("getGemURI id:",e);const t=(0,De.v)().web3Instance,n=new t.eth.Contract(Ze,C.value);n.methods.tokenURI(e).call().then((function(t){if(!t.length)return void Ae.log("getGemURI length: ",t.length);Ae.log("getGemURI: ",t);const n=parseInt(e),s=JSON.parse(t),o=(0,De.v)().web3.utils.toHex(s.properties);let i=10,r=10;for(let e=2;e<14;e++){const t=parseInt(o[e],16);e<8?i+=t:e<14&&(r+=t)}const c={nft:n,level:s.level,color:s.color,quality:i,scale:r/100,properties:o,text:""};for(let e=0;e<a.value.length;e++){const t=a.value[e];t.nft==n&&a.value.splice(e,1)}U(c,n),localStorage.setItem("userGems",JSON.stringify(l.value))})).catch((function(e){Ae.log("getGemURI: ",e)}))}))}function D(){return Le(this,void 0,void 0,(function*(){const e="https://g19udojubwks.usemoralis.com:2053/server",t="P749qSdfiW93rIsFAtUSWNAnJK4HX8hyvauadRFz";yield Re().start({serverUrl:e,appId:t});const n=(0,De.v)().account,s=(0,De.v)().web3Instance;if(!s.utils.isAddress(n))return alert("Need Connect Wallet!"),void Ae.log("Not Address:",n);try{const e=yield Re().Web3API.account.getNFTsForContract({chain:k,address:n,token_address:C.value}),t=e.result||[];$(t);let s=[];a.value=[],t.forEach((e=>{const t=parseInt(e.token_id);if(e.token_uri){const n=JSON.parse(e.token_uri),l=(0,De.v)().web3.utils.toHex(n.properties);let a=10,s=10;for(let e=2;e<14;e++){const t=parseInt(l[e],16);e<8?a+=t:e<14&&(s+=t)}const o={nft:t,level:n.level,color:n.color,quality:a,scale:s/100,properties:l,text:""};U(o,t)}else{const n={nft:t,level:8,color:0,quality:10,scale:1,properties:"0xffffffffffff",text:""};s.push(e.token_id);let o=!1;for(let e=0;e<l.value.length;e++){const n=l.value[e];if(n.nft==t){o=!0;break}}o||(a.value.unshift(n),Ae.log(n))}})),S(s),localStorage.setItem("userGems",JSON.stringify(l.value)),E(!1)}catch(o){Ae.log(o)}}))}function N(e,t){var n="0";for(let l=0;l<e.length;l++){const a=e[l];if(a.address.toUpperCase()==t.toUpperCase()){const e=(0,De.v)().web3.eth.abi.decodeParameters([{type:"uint256",name:"color"},{type:"uint256",name:"from1"},{type:"uint256",name:"from2"},{type:"uint256",name:"fromLevel"},{type:"uint256",name:"rate"},{type:"uint256",name:"gemId"}],a.data);n=e.gemId.toString();break}}return parseInt(n)}function H(e,t){return Le(this,void 0,void 0,(function*(){if(!(0,De.v)().web3.utils.isAddress((0,De.v)().account))return void alert("Need Connect Wallet!");const n=G.value,l=yield I();if(l!=(0,De.v)().networks[n].id)return Ae.log(l,"!=",(0,De.v)().networks[n].id),void(h.value=!0);m.value="",d.value="",f.value=1,u.value=!0;const a=(0,De.v)().web3,s=q.value,o=(0,De.v)().account,i=new a.eth.Contract($e,s);let r=i.methods.combineGem(e,t),c=r.encodeABI();a.eth.estimateGas({from:o,to:s,value:0,data:c}).then((function(e){Ae.log("gasAmount: ",e),a.eth.sendTransaction({from:o,to:s,value:0,gas:parseInt((1.05*e).toString()),gasPrice:36e9,data:c}).on("transactionHash",(e=>{Ae.log("transactionHash: ",e),f.value=2,d.value=e})).on("receipt",(e=>{const t=N(e.logs,s);Ae.log("gemId:",t),v.value=t,f.value=3,D()})).on("error",(e=>{Ae.log("tx combineGem",e),m.value=e.message,f.value=1}))})).catch((function(e){Ae.log("estimateGas: ",e);let t=e.message.toString(),n=t.split(".")[1],l=JSON.parse(n),a=l.message.split(":");m.value=a[0]+": "+a[1]}))}))}function R(){return Le(this,void 0,void 0,(function*(){const e=(0,De.v)().account,n=(0,De.v)().web3Instance;if(!n.utils.isAddress(e))return alert("Need Connect Wallet!"),void Ae.log("Not Address:",e);Ae.log("listenGemCombine:",e);const a=new n.eth.Contract($e,q.value),s={filter:{user:e},fromBlock:28954784};a.events.GemCombine(s).on("data",(function(e){if(!e.removed){const n=e.returnValues,a=n.gemId,s={color:parseInt(n.color),from1:parseInt(n.from1),from2:parseInt(n.from2),fromLevel:parseInt(n.fromLevel),gemId:parseInt(a),rate:parseInt(n.rate),user:n.user,success:void 0!=t.value[a]&&void 0!=t.value[a].success?t.value[a].success:"",toLevel:void 0!=t.value[a]&&void 0!=t.value[a].toLevel?t.value[a].toLevel:-1,uri:void 0!=t.value[a]&&void 0!=t.value[a].uri?t.value[a].uri:""};t.value[a]=s,Z(n.from1),Z(n.from2),localStorage.setItem("userGems",JSON.stringify(l.value)),E(!1)}})).on("changed",(function(e){Ae.log("listenGemCombine changed:",e)})).on("error",(function(e){Ae.log("listenGemCombine Err:",e)})).on("connected",(function(e){Ae.log("listenGemCombine subscription id:",e)}))}))}function A(){return Le(this,void 0,void 0,(function*(){const e=(0,De.v)().account,n=(0,De.v)().web3Instance;if(!n.utils.isAddress(e))return alert("Need Connect Wallet!"),void Ae.log("Not Address:",e);Ae.log("listenGemSettled:",e);const l=new n.eth.Contract($e,q.value),a={filter:{user:e},fromBlock:28954784};l.events.GemSettled(a).on("data",(function(e){if(!e.removed){const n=e.returnValues,l=n.gemId,a={color:parseInt(n.color),from1:parseInt(n.from1),from2:parseInt(n.from2),gemId:parseInt(l),user:n.user,success:n.success,toLevel:parseInt(n.toLevel),uri:n.uri,rate:void 0!=t.value[l]&&void 0!=t.value[l].rate?t.value[l].rate:0,fromLevel:void 0!=t.value[l]?void 0!=t.value[l].fromLevel?t.value[l].fromLevel:"true"==n.success?parseInt(n.toLevel)-1:-1:-1};t.value[l]=a,parseInt(l)==v.value&&(p.value={nft:parseInt(l),level:parseInt(n.toLevel),color:parseInt(n.color),quality:Q(n.uri).quality,scale:Q(n.uri).scale,properties:"",text:""},f.value=4)}})).on("changed",(function(e){Ae.log("listenGemSettled changed:",e)})).on("error",(function(e){Ae.log("listenGemSettled Err:",e)})).on("connected",(function(e){Ae.log("listenGemSettled subscription id:",e)}))}))}function L(){return Le(this,void 0,void 0,(function*(){const e=(0,De.v)().account,n=(0,De.v)().web3Instance;if(!n.utils.isAddress(e))return alert("Need Connect Wallet!"),void Ae.log("Not Address:",e);Ae.log("getAllEvents:",e);const l=new n.eth.Contract($e,q.value),a={filter:{user:e},fromBlock:28954784,toBlock:"latest"};l.getPastEvents("GemSettled",a).then((function(e){Ae.log("GemSettled:",e),e.forEach((e=>{if(e.removed)Ae.log("event.removed: ",e);else{const n=e.returnValues,l=n.gemId,a={color:parseInt(n.color),from1:parseInt(n.from1),from2:parseInt(n.from2),gemId:parseInt(l),user:n.user,success:n.success,toLevel:parseInt(n.toLevel),uri:n.uri,rate:void 0!=t.value[l]?t.value[l].rate:0,fromLevel:void 0!=t.value[l]?t.value[l].fromLevel:"true"==n.success?parseInt(n.toLevel)-1:-1};t.value[l]=a}}))})).catch((function(e){Ae.log("getAllEvents Err: ",e)}))}))}function U(e,t){let n=!1;for(let a=0;a<l.value.length;a++){const e=l.value[a];if(e.nft==t){n=!0;break}}n||(l.value.unshift(e),Ae.log(e))}function Z(e){for(let t=0;t<l.value.length;t++){const n=l.value[t];if(n.nft==e){l.value.splice(t,1);break}}}function $(e){for(let t=0;t<l.value.length;t++){const n=l.value[t];let a=!1;for(let t=0;t<e.length;t++){const l=e[t].token_id;if(l==n.nft){a=!0;break}}a||l.value.splice(t,1)}}function E(e){i.value=void 0,r.value=void 0,c.value=void 0;for(let n=0;n<6;n++)for(let e=0;e<16;e++)y[n][e]=0;for(let n=0;n<l.value.length;n++){const e=l.value[n],t=e.color,a=e.level;y[t][a]+=1}let t=[];for(let n=0;n<6;n++)for(let e=0;e<15;e++)if(y[n][e]>=2){const l=Math.floor(y[n][e]/2);g[n][e+1]=l;const a={nft:0,level:e+1,color:n,quality:100,scale:1,properties:"0xffffffffffff",text:l.toString()};t.push(a)}s.value=t}function j(e,t){switch(t){case 0:c.value=e,o.value=[];for(let t=0;t<l.value.length;t++){const n=l.value[t];n.color==e.color&&n.level+1==e.level&&o.value.push(n)}o.value.sort((function(e,t){return e.quality<t.quality?1:e.quality>t.quality?-1:0})),i.value=o.value[0],r.value=o.value[1];break;case 1:i.value=e;break;case 2:r.value=e;break;default:Ae.log("default");break}b.value=!1,x.value=!1}function Q(e){const t=JSON.parse(e),n=(0,De.v)().web3.utils.toHex(t.properties);let l=10,a=10;for(let s=2;s<14;s++){const e=parseInt(n[s],16);s<8?l+=e:s<14&&(a+=e)}return{quality:l,scale:a/100}}function M(){Ae.log(t.value["7600"])}let O={};for(let V=0;V<101;V++)O[V.toString()]=0;return{test:M,shortAddress:Ne.sC,copyAddress:Ne.c4,linkAddress:Ne.ol,uriToNum:Q,signTx:u,signTxErr:m,signTxHash:d,txStep:f,txGem:v,txGemDetail:p,gemNftContract:C,combineContract:q,netIndex:G,chain:k,switchNet:h,chooseTar:b,chooseFrom:x,chooseNum:_,userGems:l,newGems:a,canCombineGems:s,fromGems:o,fromGem1:i,fromGem2:r,toCombineGem:c,gemTree:y,combineTree:g,combineEvents:t,updateEvents:n,checkNetwork:I,switchNetwork:T,getUserGems:D,combineGemTx:H,listenGemCombine:R,listenGemSettled:A,getAllEvents:L,updateTree:E,setToCombine:j,initGame(){return Le(this,void 0,void 0,(function*(){let e=new URLSearchParams(window.location.search),t=e.get("ref");Ae.log(t||"No Ref");const n=G.value;Ee(n);const l=yield I();if(l!=(0,De.v)().networks[n].id)return Ae.log(l,"!=",(0,De.v)().networks[n].id),void(h.value=!0);R(),A()}))},combineClicked(){return Le(this,void 0,void 0,(function*(){void 0!=i.value&&void 0!=r.value&&i.value.level==r.value.level&&i.value.color==r.value.color&&(Ae.log("Combine Gems: ",i.value.nft,r.value.nft),H(i.value.nft,r.value.nft),i.value=void 0,r.value=void 0,c.value=void 0)}))},getRarity(e){let t="Common",n="C";switch(e){case 4:case 5:case 6:case 7:n="UC";break;case 8:case 9:n="R";break;case 10:n="RR";break;case 11:n="RRR";break;case 12:n="SR";break;case 13:n="HR";break;case 14:n="UR";break;case 15:n="SSR";break;default:break}switch(e){case 4:case 5:case 6:case 7:t="Uncommon";break;case 8:case 9:case 10:case 11:t="Rare";break;case 12:case 13:case 14:case 15:t="Epic";break;default:break}return{rarity:t,short:n}},initDate(){localStorage.getItem("userGems")&&(Object.assign(l.value,JSON.parse(localStorage.getItem("userGems")||"")),l.value.sort((function(e,t){return e.nft<t.nft?1:e.nft>t.nft?-1:0})))}}},beforeMount(){this.initDate(),this.initGame(),this.getUserGems(),this.updateTree(!1)}});var Me=n(11639),Oe=n(69885),Ve=n(89800),Pe=n(84106),Fe=n(63190),Je=n(57691),Be=n(68879),Ke=n(13246),Ye=n(490),Xe=n(76749),et=n(33115),tt=n(32074),nt=n(44458),lt=n(61357),at=n(90136),st=n(11821),ot=n(8225),it=n(46017),rt=n(21992),ct=n(8289),ut=n(62146),mt=n(69984),dt=n.n(mt);const ft=(0,Me.Z)(Qe,[["render",Ce],["__scopeId","data-v-4eef94d6"]]),vt=ft;dt()(Qe,"components",{QPage:Oe.Z,QTabPanels:Ve.Z,QTabPanel:Pe.Z,QCardSection:Fe.Z,QChip:Je.Z,QBtn:Be.Z,QList:Ke.Z,QItem:Ye.Z,QItemSection:Xe.Z,QItemLabel:et.Z,QDialog:tt.Z,QCard:nt.Z,QAvatar:lt.Z,QSpace:at.Z,QCardActions:st.Z,QStepper:ot.Z,QStep:it.Z,QStepperNavigation:rt.Z,QLinearProgress:ct.Z}),dt()(Qe,"directives",{ClosePopup:ut.Z})},72593:e=>{e.exports=JSON.parse('[{"inputs":[{"internalType":"address","name":"gem","type":"address"},{"internalType":"address","name":"rand","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"newGame","type":"address"}],"name":"GameAdded","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"removedGame","type":"address"}],"name":"GameRemoved","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"color","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"from1","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"from2","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"fromLevel","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"rate","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"gemId","type":"uint256"}],"name":"GemCombine","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"color","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"from1","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"from2","type":"uint256"},{"indexed":false,"internalType":"bool","name":"success","type":"bool"},{"indexed":false,"internalType":"uint256","name":"gemId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"toLevel","type":"uint256"},{"indexed":false,"internalType":"string","name":"uri","type":"string"}],"name":"GemSettled","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"inputs":[{"internalType":"address","name":"newGame","type":"address"}],"name":"addGame","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"gem1","type":"uint256"},{"internalType":"uint256","name":"gem2","type":"uint256"}],"name":"combineGem","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"games","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"who","type":"address"}],"name":"isGame","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"game","type":"address"}],"name":"removeGame","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_contract","type":"address"}],"name":"setGem","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"requestId","type":"bytes32"},{"internalType":"uint256","name":"randomness","type":"uint256"}],"name":"settleRand","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"toggleGameIsLive","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"}]')}}]);