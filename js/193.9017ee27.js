"use strict";(self["webpackChunkcrystal_dapp"]=self["webpackChunkcrystal_dapp"]||[]).push([[193],{55980:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Ce});var n=a(59835),l=a(86970);const o=e=>((0,n.dD)("data-v-07dfcb1f"),e=e(),(0,n.Cn)(),e),s={class:"q-pa-md",style:{"max-width":"1439px"}},r={class:"min-width-320 text-white text-h6 text-bold text-center"},i=o((()=>(0,n._)("div",{class:"gem-glory-box"},[(0,n._)("div",{class:"gem-glory"})],-1))),c={class:"gem-box"},d={key:0,class:"q-gutter-sm"},u={class:"self-center full-width no-outline text-center text-h6"},m={class:"self-center full-width no-outline text-center"},p={class:"self-center full-width no-outline",tabindex:"0"},f={class:"self-center full-width no-outline",tabindex:"0"},g=(0,n.Uk)(" Link Copied "),w={key:1,class:"q-gutter-sm"},v={class:"self-center full-width no-outline text-center text-h6"},h={style:{"text-decoration":"line-through"}},b={class:"self-center full-width no-outline text-center"},x=o((()=>(0,n._)("span",{class:"text-h6 q-ml-sm"},"Redeem Gem",-1))),k={class:"q-pa-xs"},_={key:0,class:"text-left"},y=o((()=>(0,n._)("a",null,[(0,n._)("span",{class:"cursor-pointer"}," Sign transaction with your wallet and we will never touch your private key! ")],-1))),I=[y],S={key:1,class:"text-left text-red"},W=["href"],C={class:"cursor-pointer"},q=o((()=>(0,n._)("a",null,[(0,n._)("span",{class:"cursor-pointer"}," Transaction is broadcasted, waiting for confirmation. ")],-1))),A={class:"row"},N=o((()=>(0,n._)("div",{class:"gem-frame row items-center justify-evenly"},[(0,n._)("div",{class:"text-h3"},"?")],-1))),Z={class:"info",style:{"text-shadow":"#000 1px 0 10px"}},z={class:"text-h6 gem-name"},H={class:"text-subtitle1"},U={class:"gem-level"},G={class:"gem-scale"},Q={class:"gem-quality"},T=o((()=>(0,n._)("br",null,null,-1))),$={class:"cursor-pointer"},D=o((()=>(0,n._)("br",null,null,-1))),P=o((()=>(0,n._)("span",{class:"text-subtitle2 text-secondary q-ml-sm"},"https://crystal.network",-1))),V=o((()=>(0,n._)("span",{class:"text-h6 q-ml-sm"},"Incorrect blockchain",-1))),F=o((()=>(0,n._)("span",{class:"q-ml-sm"},"You are currently not connected to the correct network.",-1)));function E(e,t,a,o,y,E){const O=(0,n.up)("q-btn"),B=(0,n.up)("q-icon"),R=(0,n.up)("q-field"),j=(0,n.up)("q-banner"),J=(0,n.up)("q-popup-proxy"),M=(0,n.up)("q-input"),L=(0,n.up)("q-card-section"),K=(0,n.up)("q-card"),Y=(0,n.up)("q-tab-panel"),X=(0,n.up)("q-tab-panels"),ee=(0,n.up)("nft-menu"),te=(0,n.up)("q-space"),ae=(0,n.up)("q-step"),ne=(0,n.up)("q-linear-progress"),le=(0,n.up)("q-stepper"),oe=(0,n.up)("q-dialog"),se=(0,n.up)("q-avatar"),re=(0,n.up)("q-card-actions"),ie=(0,n.up)("q-page"),ce=(0,n.Q2)("close-popup");return(0,n.wg)(),(0,n.j4)(ie,{class:"row items-center justify-evenly bg-pic",style:{"padding-top":"58px"}},{default:(0,n.w5)((()=>[(0,n._)("div",s,[(0,n.Wm)(X,{class:"bg-none",flat:"","model-value":"gacha",animated:""},{default:(0,n.w5)((()=>[(0,n.Wm)(Y,{name:"gacha",class:"q-pa-none"},{default:(0,n.w5)((()=>[(0,n.Wm)(K,{class:"bg-glass",style:{"max-width":"340px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(L,{class:"row q-gutter-sm justify-evenly"},{default:(0,n.w5)((()=>[(0,n._)("div",r,(0,l.zw)(e.$t("airdrop.openGemChest")),1),i,(0,n._)("div",c,[(0,n.Wm)(O,{flat:"",class:"gem-in-box","text-color":"grey",label:"?"},{default:(0,n.w5)((()=>[(0,n._)("img",{class:"gem",src:"/gems/shine.png",alt:"shine",onClick:t[0]||(t[0]=(...t)=>e.newSample&&e.newSample(...t))})])),_:1})]),"0"!==e.userInfo.id?((0,n.wg)(),(0,n.iD)("div",d,[(0,n.Wm)(R,{dense:"","stack-label":"",readonly:"",class:"min-width-320"},{control:(0,n.w5)((()=>[(0,n._)("div",u,[(0,n.Uk)((0,l.zw)(e.$n(parseInt(e.minerInfo.price.value)))+" ",1),(0,n.Wm)(B,{name:"las la-gem"})]),(0,n._)("div",m,(0,l.zw)(e.$t("airdrop.priceUnit")),1)])),_:1}),(0,n.Wm)(R,{outlined:"","stack-label":"",label:e.$t("airdrop.balance"),readonly:"",class:"min-width-320"},{control:(0,n.w5)((()=>[(0,n._)("div",p,(0,l.zw)(e.$t("airdrop.points")+":"),1)])),append:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(e.$n(parseInt(e.memberInfo.score)))+" ",1),(0,n.Wm)(O,{round:"",dense:"",flat:"",icon:"las la-gem",to:"games"})])),_:1},8,["label"]),(0,n.Wm)(O,{unelevated:"",color:"primary",class:"min-width-320","no-caps":"",onClick:t[1]||(t[1]=t=>e.redeemGem())},{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(e.$t("airdrop.redeem")),1)])),_:1}),(0,n.Wm)(R,{filled:"","bg-color":"black","stack-label":"",label:e.$t("airdrop.referralLink"),"bottom-slots":"",readonly:"",class:"min-width-320"},{control:(0,n.w5)((()=>[(0,n._)("div",f," Crystal.Network/Airdrop?ref="+(0,l.zw)(e.userInfo.id),1)])),append:(0,n.w5)((()=>[(0,n.Wm)(O,{round:"",dense:"",flat:"",icon:"content_copy",color:"white",onClick:t[2]||(t[2]=t=>e.copyAddress("https://Crystal.Network/Airdrop?ref="+e.userInfo.id))},{default:(0,n.w5)((()=>[(0,n.Wm)(J,null,{default:(0,n.w5)((()=>[(0,n.Wm)(j,null,{avatar:(0,n.w5)((()=>[(0,n.Wm)(B,{name:"check",color:"primary"})])),default:(0,n.w5)((()=>[g])),_:1})])),_:1})])),_:1})])),hint:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(e.$t("airdrop.invitAndGet")),1)])),_:1},8,["label"])])):((0,n.wg)(),(0,n.iD)("div",w,[(0,n.Wm)(R,{dense:"","stack-label":"",readonly:"",class:"min-width-320"},{control:(0,n.w5)((()=>[(0,n._)("div",v,[(0,n._)("a",h,(0,l.zw)(e.$n(parseInt(e.minerInfo.price.value))),1),(0,n.Wm)(B,{name:"las la-gem"})]),(0,n._)("div",b,(0,l.zw)(e.$t("airdrop.priceUnit")),1)])),_:1}),(0,n.Wm)(M,{outlined:"",color:"purple-12",modelValue:e.refCode,"onUpdate:modelValue":t[3]||(t[3]=t=>e.refCode=t),type:"number",label:e.$t("airdrop.referralCode"),class:"min-width-320","input-class":"text-center text-h6"},{append:(0,n.w5)((()=>[])),_:1},8,["modelValue","label"]),(0,n.Wm)(O,{unelevated:"",color:"primary",class:"min-width-320","no-caps":"",onClick:t[4]||(t[4]=t=>e.claimClick())},{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(e.$t("airdrop.claimFreeGem")),1)])),_:1})]))])),_:1})])),_:1})])),_:1})])),_:1})]),(0,n.Wm)(ee),(0,n.Wm)(oe,{modelValue:e.signTx,"onUpdate:modelValue":t[7]||(t[7]=t=>e.signTx=t),position:"top"},{default:(0,n.w5)((()=>[(0,n.Wm)(K,{style:{top:"50px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(L,{class:"q-pa-xs row items-center q-pb-none"},{default:(0,n.w5)((()=>[x,(0,n.Wm)(te),(0,n.wy)((0,n.Wm)(O,{icon:"close",flat:"",round:"",dense:""},null,512),[[ce]])])),_:1}),(0,n.Wm)(L,{class:"row items-center q-pa-xs"},{default:(0,n.w5)((()=>[(0,n._)("div",k,[(0,n.Wm)(le,{modelValue:e.txStep,"onUpdate:modelValue":t[6]||(t[6]=t=>e.txStep=t),vertical:"",color:"primary",flat:"",animated:""},{default:(0,n.w5)((()=>[(0,n.Wm)(ae,{name:1,title:"Sign Transaction",icon:"las la-wallet",done:e.txStep>1,error:e.signTxErr.length>0},{default:(0,n.w5)((()=>[""==e.signTxErr?((0,n.wg)(),(0,n.iD)("div",_,I)):((0,n.wg)(),(0,n.iD)("div",S,(0,l.zw)(e.signTxErr),1))])),_:1},8,["done","error"]),(0,n.Wm)(ae,{name:2,title:"Send Transaction",icon:"las la-receipt",done:e.txStep>2},{default:(0,n.w5)((()=>[(0,n._)("a",{href:e.linkAddress(e.signTxHash,e.netIndex,"tx"),target:"_blank",class:"text-grey-6"},[(0,n._)("span",C,(0,l.zw)(" tx hash: "+e.shortAddress(e.signTxHash,6,!1)),1)],8,W),q,(0,n.Wm)(ne,{dark:"",rounded:"",indeterminate:"",color:"secondary",class:"q-mt-sm"})])),_:1},8,["done"]),(0,n.Wm)(ae,{name:3,title:"Waiting for Result",icon:"las la-hourglass-half",done:e.txStep>3},{default:(0,n.w5)((()=>[(0,n._)("div",A,[N,(0,n._)("div",Z,[(0,n._)("div",z,[(0,n.Uk)((0,l.zw)(e.$t("airdrop.gotGemNft")+":")+" ",1),(0,n._)("span",H,"#"+(0,l.zw)(e.txGem),1)]),(0,n._)("div",U,(0,l.zw)(e.$t("gems.level")+":")+" ??? ",1),(0,n._)("div",G,(0,l.zw)(e.$t("gems.weight")+":")+" ??? ",1),(0,n._)("div",Q,(0,l.zw)(e.$t("gems.quality")+":")+" ??? ",1)])]),T,(0,n._)("a",null,[(0,n._)("span",$,(0,l.zw)(e.$t("airdrop.whenAppear")),1)]),D,(0,n.Wm)(O,{onClick:t[5]||(t[5]=t=>e.signTx=!1),color:"primary",label:"OK",class:"q-ml-sm full-width",dense:""})])),_:1},8,["done"])])),_:1},8,["modelValue"])])])),_:1}),(0,n.Wm)(L,{class:"q-pa-xs row items-center q-pb-none"},{default:(0,n.w5)((()=>[P])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,n.Wm)(oe,{modelValue:e.switchNet,"onUpdate:modelValue":t[9]||(t[9]=t=>e.switchNet=t),persistent:""},{default:(0,n.w5)((()=>[(0,n.Wm)(K,{class:"bg-glass"},{default:(0,n.w5)((()=>[(0,n.Wm)(L,{class:"row items-center q-pb-none"},{default:(0,n.w5)((()=>[(0,n.Wm)(se,{icon:"signal_wifi_off",color:"primary","text-color":"white",size:"xs"}),V,(0,n.Wm)(te),(0,n.wy)((0,n.Wm)(O,{icon:"close",flat:"",round:"",dense:""},null,512),[[ce]])])),_:1}),(0,n.Wm)(L,{class:"row items-center"},{default:(0,n.w5)((()=>[F])),_:1}),(0,n.Wm)(re,{align:"right"},{default:(0,n.w5)((()=>[(0,n.wy)((0,n.Wm)(O,{class:"full-width",label:"Switch",color:"primary",onClick:t[8]||(t[8]=t=>e.switchNetwork(e.netIndex))},null,512),[[ce]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}var O=a(60499),B=a(19302),R=a(65457),j=a(44320),J=a(85990),M=a(28488),L=a(17779),K=function(e,t,a,n){function l(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,o){function s(e){try{i(n.next(e))}catch(t){o(t)}}function r(e){try{i(n["throw"](e))}catch(t){o(t)}}function i(e){e.done?a(e.value):l(e.value).then(s,r)}i((n=n.apply(e,t||[])).next())}))};const Y=a(94428),X=a(29791);function ee(e){L.log("Switch network: ",(0,J.v)().networks[e].name,(0,J.v)().networks[e].id),(0,J.v)().initWeb3(e)}const te={title:"Crystal - Gem"},ae=(0,n.aZ)({name:"NftClaimPage",components:{NftMenu:j.Z},setup(){const e=(0,B.Z)();e.dark.set(!0),(0,R.Z)(te);const t=(0,O.iH)(15),a=(0,O.iH)(!1),l=(0,O.iH)(0),o=(0,O.iH)("0xf18a1FEf4823Ce5ddb20B71D82FA06470DF84B17"),s=(0,O.iH)("0x944F2F433e4Afac933B10d465E198540DeA08D72"),r=(0,O.iH)({bets:"0",score:"0",name:"0"}),i=(0,O.iH)({id:"0",airdropped:"0",referees:"0",redeemed:"0"}),c={price:(0,O.iH)("10000")},d=(0,O.iH)(.5),u=(0,O.iH)("1"),m=(0,O.iH)(!1),p=(0,O.iH)(""),f=(0,O.iH)(""),g=(0,O.iH)(1),w=(0,O.iH)(0);function v(){return K(this,void 0,void 0,(function*(){const e=yield(0,J.v)().web3.eth.net.getId().then((e=>(L.log(e),e))).catch((e=>(L.log("checkNetwork: ",e),-1)));return e}))}function h(e){return K(this,void 0,void 0,(function*(){const t=(0,J.v)().networks[e].id,a=(0,J.v)().networks[e].name,n=(0,J.v)().networks[e].tokenName,l=(0,J.v)().networks[e].symbol,o=(0,J.v)().networks[e].rpcUrl,s=(0,J.v)().networks[e].explorer,r="0x"+t.toString(16);if("undefined"!==typeof window.ethereum)try{yield window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:r}]}),location.reload()}catch(i){if(L.log(i),4902===i.code){L.log("Add Chain");try{yield window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:r,chainName:a,nativeCurrency:{name:n,symbol:l,decimals:18},rpcUrls:[o],blockExplorerUrls:[s]}]}),location.reload()}catch(c){alert(c.message)}}else alert(i.message)}}))}function b(e){return K(this,void 0,void 0,(function*(){const t=(0,J.v)().web3Instance;if(t.utils.isAddress((0,J.v)().accountAddr)){const a=new t.eth.Contract(Y,e);a.methods.userDetail((0,J.v)().accountAddr).call().then((function(e){L.log("getMemberInfo: ",e);const t={bets:e.bets,score:e.score,name:e.name};r.value=t,localStorage.setItem("memberInfo",JSON.stringify(r.value))})).catch((function(e){L.log("getMemberInfo: ",e)}))}}))}function x(e){return K(this,void 0,void 0,(function*(){const t=(0,J.v)().web3Instance;if(t.utils.isAddress((0,J.v)().accountAddr)){const a=new t.eth.Contract(X,e);a.methods.userDetail((0,J.v)().accountAddr).call().then((function(e){L.log("getUserInfo: ",e);const t={id:e.id,referral:e.referral,airdropped:e.airdropped,referees:e.referees,redeemed:e.redeemed};i.value=t,localStorage.setItem("userInfo",JSON.stringify(i.value)),b(o.value)})).catch((function(e){L.log("getUserInfo: ",e)}))}}))}function k(){return K(this,void 0,void 0,(function*(){if(!(0,J.v)().web3.utils.isAddress((0,J.v)().account))return void alert("Need Connect Wallet!");const e=l.value,t=yield v();if(t!=(0,J.v)().networks[e].id)return L.log(t,"!=",(0,J.v)().networks[e].id),void(a.value=!0);p.value="",f.value="",g.value=1,m.value=!0;const n=(0,J.v)().web3,r=s.value,i=(0,J.v)().account,c=new n.eth.Contract(X,r);let d=c.methods.redeemGem(),u=d.encodeABI();n.eth.estimateGas({from:i,to:r,value:0,data:u}).then((function(e){L.log("gasAmount: ",e),n.eth.sendTransaction({from:i,to:r,value:0,gas:parseInt((1.05*e).toString()),gasPrice:36e9,data:u}).on("transactionHash",(e=>{L.log("transactionHash: ",e),g.value=2,f.value=e})).on("receipt",(e=>{const t=I(e.logs,r);L.log("gemId:",t),w.value=t,g.value=3,b(o.value)})).on("error",(e=>{L.log("tx redeemGem",e),p.value=e.message,g.value=1}))})).catch((function(e){L.log("estimateGas: ",e);let t=e.message.toString(),a=t.split(".")[1],n=JSON.parse(a),l=n.message.split(":");p.value=l[0]+": "+l[1]}))}))}function _(e){return K(this,void 0,void 0,(function*(){if(L.log("Referral ID:",e),!(0,J.v)().web3.utils.isAddress((0,J.v)().account))return void alert("Need Connect Wallet!");const t=l.value,n=yield v();if(n!=(0,J.v)().networks[t].id)return L.log(n,"!=",(0,J.v)().networks[t].id),void(a.value=!0);p.value="",f.value="",g.value=1,m.value=!0;const o=(0,J.v)().web3,r=s.value,i=(0,J.v)().account,c=new o.eth.Contract(X,r);let d=c.methods.claimAirdrop(o.utils.toHex(e)),u=d.encodeABI();o.eth.estimateGas({from:i,to:r,value:0,data:u}).then((function(e){L.log("gasAmount: ",e),o.eth.sendTransaction({from:i,to:r,value:0,gas:parseInt((1.05*e).toString()),gasPrice:36e9,data:u}).on("transactionHash",(e=>{L.log("transactionHash: ",e),g.value=2,f.value=e})).on("receipt",(e=>{const t=I(e.logs,r);L.log("gemId:",t),w.value=t,g.value=3,x(s.value)})).on("error",(e=>{L.log("tx claimAirdrop",e),p.value=e.message,g.value=1}))})).catch((function(e){L.log("estimateGas: ",e);let t=e.message.toString(),a=t.split(".")[1],n=JSON.parse(a),l=n.message.split(":");p.value=l[0]+": "+l[1]}))}))}function y(){let e=parseInt(u.value).toString();u.value=e,_(e)}function I(e,t){var a="0";L.log("receipt:",e);for(let n=0;n<e.length;n++){const l=e[n];if(l.address.toUpperCase()==t.toUpperCase()){L.log(l),a=(0,J.v)().web3.eth.abi.decodeParameter("uint256",l.data).toString(),L.log("Gem NFT Id: #",a);break}}return parseInt(a)}return{shortAddress:M.sC,copyAddress:M.c4,linkAddress:M.ol,signTx:m,signTxErr:p,signTxHash:f,txStep:g,txGem:w,netIndex:l,switchNet:a,memberContract:o,gemManContract:s,userInfo:i,memberInfo:r,minerInfo:c,refProgress:d,refProgressLabel:(0,n.Fl)((()=>(100*d.value).toFixed(2)+"%")),refCode:u,sampleGem:t,sampleStyle:(0,n.Fl)((()=>"transform: scale(1.0); height: 45px; width: 45px; background-blend-mode: hard-light; -webkit-mask-mode: alpha; mask-mode: alpha; background-image: url('"+t.value%16+"'), linear-gradient(#f0f0f0, #f0f0f0); -webkit-mask-image: url('"+t.value%16+"'); mask-image: url('"+t.value%16+"'); background-size: cover; -webkit-mask-size: 100%; mask-size: 100%;")),checkNetwork:v,switchNetwork:h,getMemberInfo:b,getUserInfo:x,dealRedeem:I,redeemGem:k,claimAirdrop:_,initGame(){return K(this,void 0,void 0,(function*(){let e=new URLSearchParams(window.location.search),t=e.get("ref");t=parseInt(t||"1").toString(),L.log("Referral code:",t||"No Ref"),t&&"NaN"!=t&&(localStorage.refCode=t),localStorage.refCode&&(u.value=localStorage.refCode);const n=l.value;ee(n);const o=yield v();if(o!=(0,J.v)().networks[n].id)return L.log(o,"!=",(0,J.v)().networks[n].id),void(a.value=!0);x(s.value)}))},claimClick:y,updateInputs(e){L.log("updateInputs: ",e)},gemSelected(e){L.log("Selected: ",e)},newSample(){t.value+=1},initDate(){localStorage.getItem("memberInfo")&&Object.assign(r.value,JSON.parse(localStorage.getItem("memberInfo")||"")),localStorage.getItem("userInfo")&&Object.assign(i.value,JSON.parse(localStorage.getItem("userInfo")||""))}}},beforeMount(){this.initDate(),this.initGame()}});var ne=a(11639),le=a(69885),oe=a(89800),se=a(84106),re=a(44458),ie=a(63190),ce=a(68879),de=a(18149),ue=a(22857),me=a(52765),pe=a(47128),fe=a(66611),ge=a(32074),we=a(90136),ve=a(8225),he=a(46017),be=a(21992),xe=a(8289),ke=a(61357),_e=a(11821),ye=a(62146),Ie=a(69984),Se=a.n(Ie);const We=(0,ne.Z)(ae,[["render",E],["__scopeId","data-v-07dfcb1f"]]),Ce=We;Se()(ae,"components",{QPage:le.Z,QTabPanels:oe.Z,QTabPanel:se.Z,QCard:re.Z,QCardSection:ie.Z,QBtn:ce.Z,QField:de.Z,QIcon:ue.Z,QPopupProxy:me.Z,QBanner:pe.Z,QInput:fe.Z,QDialog:ge.Z,QSpace:we.Z,QStepper:ve.Z,QStep:he.Z,QStepperNavigation:be.Z,QLinearProgress:xe.Z,QAvatar:ke.Z,QCardActions:_e.Z}),Se()(ae,"directives",{ClosePopup:ye.Z})}}]);