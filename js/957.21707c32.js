"use strict";(self["webpackChunkcrystal_dapp"]=self["webpackChunkcrystal_dapp"]||[]).push([[957],{51778:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ne});var n=a(59835),o=a(86970);const l={class:"q-pa-md",style:{width:"100%","max-width":"1439px"}},s=(0,n._)("br",null,null,-1),i={class:"q-pa-md col-3 col-md-4 col-sm-6 col-xs-12"},r={class:"q-gutter-x-sm",style:{"z-index":"2"}},c=["src"],u={class:"q-gutter-x-sm",style:{"z-index":"1",position:"absolute",top:"0px",left:"0px"}},d=["src"],m=["href"],w={class:"cursor-pointer"},f=(0,n.Uk)(" House Edge "),v=(0,n.Uk)(" Coming soon... "),p=(0,n._)("span",{class:"text-h6 q-ml-sm"},"Incorrect blockchain",-1),h=(0,n._)("span",{class:"q-ml-sm"},"You are currently not connected to the correct network.",-1);function g(e,t,a,g,k,_){const y=(0,n.up)("q-icon"),W=(0,n.up)("q-btn"),b=(0,n.up)("q-page-sticky"),I=(0,n.up)("q-avatar"),x=(0,n.up)("q-item-section"),q=(0,n.up)("q-item-label"),Z=(0,n.up)("q-item"),C=(0,n.up)("q-chip"),H=(0,n.up)("q-card-section"),Q=(0,n.up)("q-separator"),A=(0,n.up)("q-tab"),U=(0,n.up)("q-tabs"),N=(0,n.up)("q-card-actions"),S=(0,n.up)("q-card"),z=(0,n.up)("q-space"),P=(0,n.up)("q-dialog"),T=(0,n.up)("BalanceView"),V=(0,n.up)("q-page"),E=(0,n.Q2)("close-popup");return(0,n.wg)(),(0,n.j4)(V,{class:"row justify-evenly"},{default:(0,n.w5)((()=>[(0,n.Wm)(b,{position:"top-left",offset:[0,0],style:{"z-index":"999"}},{default:(0,n.w5)((()=>[(0,n.Wm)(W,{flat:"","no-caps":"",to:"/"},{default:(0,n.w5)((()=>[(0,n.Wm)(y,{name:"las la-angle-double-left"})])),_:1}),(0,n.Wm)(W,{flat:"","no-caps":"",onClick:e.refresh},{default:(0,n.w5)((()=>[(0,n.Wm)(y,{name:"las la-sync"})])),_:1},8,["onClick"])])),_:1}),(0,n._)("div",l,[s,(0,n._)("div",i,[(0,n.Wm)(S,{class:"my-card"},{default:(0,n.w5)((()=>[(0,n.Wm)(H,{class:"bg-primary text-white"},{default:(0,n.w5)((()=>[(0,n.Wm)(Z,null,{default:(0,n.w5)((()=>[(0,n.Wm)(x,{avatar:""},{default:(0,n.w5)((()=>[(0,n._)("div",r,[(0,n.Wm)(I,{size:"48px"},{default:(0,n.w5)((()=>[(0,n._)("img",{src:"tokens/"+e.token+".png"},null,8,c)])),_:1})]),(0,n._)("div",u,[(0,n.Wm)(I,{size:"30px",color:"white"},{default:(0,n.w5)((()=>[(0,n._)("img",{src:"chains/"+e.networkName+".svg",style:{width:"60%"}},null,8,d)])),_:1})])])),_:1}),(0,n.Wm)(x,null,{default:(0,n.w5)((()=>[(0,n.Wm)(q,{class:"text-h6"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(e.gameName),1)])),_:1}),(0,n.Wm)(q,{caption:""},{default:(0,n.w5)((()=>[(0,n.Wm)(W,{size:"10px",flat:"",dense:"",icon:"open_in_new"},{default:(0,n.w5)((()=>[(0,n._)("a",{href:e.linkAddress(e.contract,e.network),target:"_blank",class:"text-white"},[(0,n._)("span",w,(0,o.zw)(e.shortAddress(e.contract)),1)],8,m)])),_:1})])),_:1})])),_:1})])),_:1}),(0,n.Wm)(Z,null,{default:(0,n.w5)((()=>[(0,n._)("div",null,[(0,n.Wm)(C,null,{default:(0,n.w5)((()=>[(0,n.Wm)(I,{color:"orange","text-color":"white",icon:"las la-coins"}),(0,n.Uk)(" Profit "+(0,o.zw)(e.gameInfo.profitRate.value+"%"),1)])),_:1}),(0,n.Wm)(C,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" APR "+(0,o.zw)((365*parseFloat(e.gameInfo.profitRate.value)/e.days).toFixed(2)+"%"),1)])),_:1}),(0,n.Wm)(C,null,{default:(0,n.w5)((()=>[(0,n.Wm)(I,{color:"red","text-color":"white"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(e.houseEdge+"%"),1)])),_:1}),f])),_:1}),(0,n.Wm)(C,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Rake "+(0,o.zw)(e.rake+"%"),1)])),_:1})])])),_:1})])),_:1}),(0,n.Wm)(Q),(0,n.Wm)(N,{class:"row",align:"around"},{default:(0,n.w5)((()=>[(0,n.Wm)(U,{modelValue:e.tab,"onUpdate:modelValue":t[0]||(t[0]=t=>e.tab=t),dense:"",class:"text-grey full-width","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":"",breakpoint:0},{default:(0,n.w5)((()=>[(0,n.Wm)(A,{name:"invest",label:"Invest"}),(0,n.Wm)(A,{name:"divest",label:"Divest"})])),_:1},8,["modelValue"]),v])),_:1})])),_:1})]),(0,n.Wm)(P,{modelValue:e.switchNet,"onUpdate:modelValue":t[1]||(t[1]=t=>e.switchNet=t),persistent:""},{default:(0,n.w5)((()=>[(0,n.Wm)(S,null,{default:(0,n.w5)((()=>[(0,n.Wm)(H,{class:"row items-center q-pb-none"},{default:(0,n.w5)((()=>[(0,n.Wm)(I,{icon:"signal_wifi_off",color:"primary","text-color":"white",size:"xs"}),p,(0,n.Wm)(z),(0,n.wy)((0,n.Wm)(W,{icon:"close",flat:"",round:"",dense:""},null,512),[[E]])])),_:1}),(0,n.Wm)(H,{class:"row items-center"},{default:(0,n.w5)((()=>[h])),_:1}),(0,n.Wm)(N,{align:"right"},{default:(0,n.w5)((()=>[(0,n.wy)((0,n.Wm)(W,{class:"full-width",label:"Switch",color:"primary",onClick:e.switchNetwork},null,8,["onClick"]),[[E]])])),_:1})])),_:1})])),_:1},8,["modelValue"])]),(0,n.Wm)(T)])),_:1})}var k=a(60499),_=a(85990),y=a(19302),W=a(65457),b=a(18910),I=a(28488),x=a(37948),q=a(17779),Z=function(e,t,a,n){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,l){function s(e){try{r(n.next(e))}catch(t){l(t)}}function i(e){try{r(n["throw"](e))}catch(t){l(t)}}function r(e){e.done?a(e.value):o(e.value).then(s,i)}r((n=n.apply(e,t||[])).next())}))};const C=a(57841),H={title:"Crystal - Invest"};function Q(e){q.log("Switch network: ",(0,_.v)().networks[e].name,(0,_.v)().networks[e].id),(0,_.v)().initWeb3(e)}const A=(0,n.aZ)({name:"InvestPage",components:{BalanceView:x.Z},setup(){const e=(0,b.yj)(),t=(0,y.Z)();t.dark.set(!0),(0,W.Z)(H);const a=(0,k.iH)(256e5),n=(0,k.iH)(0),o=(0,k.iH)(""),l=(0,k.iH)(""),s=(0,k.iH)("04/04/2022"),i=(0,k.iH)(1),r=(0,k.iH)(""),c=(0,k.iH)(""),u=(0,k.iH)(0),d=(0,k.iH)(0),m=(0,k.iH)(!1),w={bets:(0,k.iH)("0"),supply:(0,k.iH)("0"),invested:(0,k.iH)("0"),divisted:(0,k.iH)("0"),balance:(0,k.iH)("0"),profitRate:(0,k.iH)("0")},f=(0,_.v)();function v(){return Z(this,void 0,void 0,(function*(){const e=yield(0,_.v)().web3.eth.net.getId().then((e=>(q.log(e),e))).catch((e=>(q.log("checkNetwork: ",e),-1)));return e}))}function p(){return Z(this,void 0,void 0,(function*(){const e=(0,_.v)().networks[n.value].id,t=(0,_.v)().networks[n.value].name,a=(0,_.v)().networks[n.value].tokenName,o=(0,_.v)().networks[n.value].symbol,l=(0,_.v)().networks[n.value].rpcUrl,s=(0,_.v)().networks[n.value].explorer,i="0x"+e.toString(16);if("undefined"!==typeof window.ethereum)try{yield window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:i}]}),location.reload()}catch(r){if(q.log(r),4902===r.code){q.log("Add Chain");try{yield window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:i,chainName:t,nativeCurrency:{name:a,symbol:o,decimals:18},rpcUrls:[l],blockExplorerUrls:[s]}]}),location.reload()}catch(c){alert(c.message)}}else alert(r.message)}}))}function h(e){return Z(this,void 0,void 0,(function*(){const t=(0,_.v)().web3Instance,a=new t.eth.Contract(C,e);a.methods.gameInfo().call().then((function(e){q.log(e),w.bets.value=e[0],w.supply.value=e[1],w.invested.value=e[2],w.divisted.value=e[3],w.balance.value=e[4];const t=f.web3;let a=parseFloat(t.utils.fromWei(e[4])),n=parseFloat(t.utils.fromWei(e[2])),o=parseFloat(t.utils.fromWei(e[3])),l=a+o-n,s=100*l/n;w.profitRate.value=s.toFixed(4)})).catch((function(e){q.log("getGameInfo: ",e)}))}))}function g(e){return Z(this,void 0,void 0,(function*(){const t=(0,_.v)().web3Instance;if(t.utils.isAddress((0,_.v)().accountAddr)){const a=new t.eth.Contract(C,e);a.methods.userDetail((0,_.v)().accountAddr).call().then((function(e){q.log("getUserInfo: ",e)})).catch((function(e){q.log("getUserInfo: ",e)}))}}))}function x(e,t){return Z(this,void 0,void 0,(function*(){if(!(0,_.v)().web3.utils.isAddress((0,_.v)().accountAddr))return void alert("Need Connect Wallet!");const a=yield v();if(a!=(0,_.v)().networks[n.value].id)return q.log(a,"!=",(0,_.v)().networks[n.value].id),void(m.value=!0);const o=(0,_.v)().web3,l=new o.eth.Contract(C,t);q.log("Invest(",t,",",e,")");let s=l.methods.invest(),i=s.encodeABI();o.eth.estimateGas({from:(0,_.v)().account,to:t,value:o.utils.toWei(e.toString(),"ether"),data:i}).then((function(a){q.log("gasAmount: ",a),o.eth.sendTransaction({from:(0,_.v)().account,to:t,value:o.utils.toWei(e.toString(),"ether"),gas:parseInt((1.05*a).toString()),gasPrice:36e9,data:i}).on("transactionHash",(e=>{q.log("transactionHash: ",e)})).on("receipt",(e=>{q.log("receipt: ",e)})).on("error",(e=>{q.log("tx placeBet ",e)}))})).catch((function(e){q.log("estimateGas: ",e);let t=e.message.toString(),a=t.split(".")[1],n=JSON.parse(a),o=n.message.split(":");alert(o[0]+": "+o[1])}))}))}return{tab:(0,k.iH)("invest"),shortAddress:I.sC,copyAddress:I.c4,linkAddress:I.ol,store:f,network:n,networkName:o,switchNet:m,fromBlock:a,gameName:l,start:s,days:i,contract:r,token:c,houseEdge:u,rake:d,gameInfo:w,refresh(){q.log("Refresh"),location.reload()},initInvest(){return Z(this,void 0,void 0,(function*(){let t=0;null!=e.query.game?t=parseInt(e.query.game.toString()):q.log("Default game");let a=f.gameList[t];l.value=a.name,n.value=a.networkId,o.value=(0,_.v)().networks[a.networkId].name.toLowerCase(),r.value=a.contract,c.value=a.token,u.value=a.houseEdge,d.value=a.rake,s.value=a.start;let w=new Date(s.value),p=new Date;i.value=Math.round(p.getTime()-w.getTime())/864e5,q.log("Init Invest: ",t),Q(a.networkId);const h=yield v();if(h!=(0,_.v)().networks[n.value].id)return q.log(h,"!=",(0,_.v)().networks[n.value].id),void(m.value=!0)}))},checkNetwork:v,switchNetwork:p,investTx:x,getGameInfo:h,getUserInfo:g}},beforeMount(){this.initInvest(),this.getGameInfo(this.contract),this.getUserInfo(this.contract)}});var U=a(11639),N=a(69885),S=a(3388),z=a(68879),P=a(22857),T=a(44458),V=a(63190),E=a(490),F=a(76749),R=a(61357),B=a(33115),D=a(57691),G=a(11821),j=a(50926),L=a(47817),M=a(70900),J=a(32074),O=a(90136),Y=a(18149),K=a(84106),X=a(68989),$=a(62146),ee=a(69984),te=a.n(ee);const ae=(0,U.Z)(A,[["render",g]]),ne=ae;te()(A,"components",{QPage:N.Z,QPageSticky:S.Z,QBtn:z.Z,QIcon:P.Z,QCard:T.Z,QCardSection:V.Z,QItem:E.Z,QItemSection:F.Z,QAvatar:R.Z,QItemLabel:B.Z,QChip:D.Z,QCardActions:G.Z,QSeparator:j.Z,QTabs:L.Z,QTab:M.Z,QDialog:J.Z,QSpace:O.Z,QField:Y.Z,QTabPanel:K.Z,QTable:X.Z}),te()(A,"directives",{ClosePopup:$.Z})}}]);