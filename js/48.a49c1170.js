"use strict";(self["webpackChunkcrystal_dapp"]=self["webpackChunkcrystal_dapp"]||[]).push([[48],{70199:(e,t,l)=>{l.r(t),l.d(t,{default:()=>ht});var n=l(59835),a=l(86970);const s=e=>((0,n.dD)("data-v-8a55edfa"),e=e(),(0,n.Cn)(),e),o={class:"q-pa-md",style:{"max-width":"1439px"}},i={class:"row q-pa-none justify-center",style:{"max-width":"540px"}},r=["onClick"],c={class:"gem-count text-right text-bold"},u=s((()=>(0,n._)("i",{class:"mdi-blank"},null,-1))),m=s((()=>(0,n._)("i",{class:"mdi-blank"},null,-1))),d={class:"gem-box row items-center justify-evenly"},v={key:1,class:"nft-id"},f=s((()=>(0,n._)("i",{class:"las la-angle-down inline",sixe:"xs"},null,-1))),p=[f],y=s((()=>(0,n._)("div",{class:"text-h6"},[(0,n._)("i",{class:"las la-plus"})],-1))),g={class:"gem-box row items-center justify-evenly"},w={key:1,class:"nft-id"},h=s((()=>(0,n._)("i",{class:"las la-angle-down",sixe:"xs"},null,-1))),b=[h],x=s((()=>(0,n._)("i",{class:"mdi-blank"},null,-1))),_=s((()=>(0,n._)("i",{class:"mdi-blank"},null,-1))),k=s((()=>(0,n._)("div",{class:"text-center"},[(0,n._)("i",{class:"las la-angle-double-down"})],-1))),G={class:"gem-box row items-center justify-evenly"},q={key:1,class:"info",style:{"text-shadow":"#000 1px 0 10px",position:"absolute",transform:"translate(0%, -50%)",top:"50%",left:"50%","padding-left":"35px"}},C={class:""},I={class:"gem-level q-pr-sm"},T={class:"q-pr-sm text-h6"},W={class:"gem-quality text-caption text-grey text-center"},S=s((()=>(0,n._)("div",{class:"text-center"},null,-1))),z={class:"q-py-md row items-center justify-evenly"},D={class:"gem-id text-center"},N=s((()=>(0,n._)("div",{class:"text-h6"},[(0,n._)("i",{class:"las la-plus"})],-1))),H={class:"gem-id text-center"},L=s((()=>(0,n._)("div",{class:"text-h6"},[(0,n._)("i",{class:"las la-angle-double-right"})],-1))),R={key:0},A={class:"gem-id text-center"},U={key:1,class:"text-h6"},Z=s((()=>(0,n._)("i",{class:"las la-question"},null,-1))),$=[Z],j=s((()=>(0,n._)("span",{class:"text-h6 q-ml-sm"},"Incorrect blockchain",-1))),E=s((()=>(0,n._)("span",{class:"q-ml-sm"},"You are currently not connected to the correct network.",-1))),Q={class:"info row",style:{"text-shadow":"#000 1px 0 10px"}},V={class:"text-h6"},P={key:0,class:"gem-box row items-center justify-evenly"},M={class:"nft-id-2"},O=["onClick"],F=s((()=>(0,n._)("i",{class:"las la-plus"},null,-1))),B=[F],J=s((()=>(0,n._)("br",null,null,-1))),K=(0,n.Uk)(" Choose a Target "),Y=["onClick"],X={class:"gem-count text-right text-bold"},ee=s((()=>(0,n._)("span",{class:"text-h6 q-ml-sm"},"Combine Gem",-1))),te={class:"q-pa-xs"},le={key:0,class:"text-left"},ne=s((()=>(0,n._)("a",null,[(0,n._)("span",{class:"cursor-pointer"}," Sign transaction with your wallet and we will never touch your private key! ")],-1))),ae=[ne],se={key:1,class:"text-left text-red"},oe=["href"],ie={class:"cursor-pointer"},re=s((()=>(0,n._)("a",null,[(0,n._)("span",{class:"cursor-pointer"}," Transaction is broadcasted, waiting for confirmation. ")],-1))),ce={class:"row"},ue=s((()=>(0,n._)("div",{class:"gem-frame row items-center justify-evenly col"},[(0,n._)("div",{class:"text-h3"},"?")],-1))),me={class:"gem-info",style:{"text-shadow":"#000 1px 0 10px"}},de={class:"text-h6 gem-name"},ve={class:"gem-level"},fe={class:"gem-scale"},pe={class:"gem-quality"},ye=s((()=>(0,n._)("br",null,null,-1))),ge={class:"cursor-pointer"},we={class:"row result"},he={class:"gem-frame row items-center justify-evenly col"},be={class:"gem-info",style:{"text-shadow":"#000 1px 0 10px"}},xe={class:"text-bold text-grey"},_e={class:"row"},ke={class:"gem-level q-pr-sm"},Ge={class:"gem-scale q-pr-sm"},qe={class:"gem-quality q-pr-sm"},Ce=s((()=>(0,n._)("div",{style:{height:"10px",width:"100%"}},null,-1))),Ie=s((()=>(0,n._)("span",{class:"text-subtitle2 text-secondary q-ml-sm"},"https://crystal.network",-1)));function Te(e,t,l,s,f,h){const Z=(0,n.up)("CrystalGem"),F=(0,n.up)("q-card-section"),ne=(0,n.up)("q-btn"),Te=(0,n.up)("q-separator"),We=(0,n.up)("q-badge"),Se=(0,n.up)("q-item-section"),ze=(0,n.up)("q-item"),De=(0,n.up)("q-list"),Ne=(0,n.up)("q-icon"),He=(0,n.up)("q-tab-panel"),Le=(0,n.up)("q-tab-panels"),Re=(0,n.up)("nft-menu"),Ae=(0,n.up)("q-avatar"),Ue=(0,n.up)("q-space"),Ze=(0,n.up)("q-card-actions"),$e=(0,n.up)("q-card"),je=(0,n.up)("q-dialog"),Ee=(0,n.up)("q-step"),Qe=(0,n.up)("q-linear-progress"),Ve=(0,n.up)("q-chip"),Pe=(0,n.up)("q-stepper"),Me=(0,n.up)("BalanceView"),Oe=(0,n.up)("q-page"),Fe=(0,n.Q2)("close-popup");return(0,n.wg)(),(0,n.j4)(Oe,{class:"row justify-evenly bg-pic",style:{"padding-top":"58px"}},{default:(0,n.w5)((()=>[(0,n._)("div",o,[(0,n.Wm)(Le,{class:"",flat:"","model-value":"crafting",animated:""},{default:(0,n.w5)((()=>[(0,n.Wm)(He,{class:"items-center q-pa-xs",name:"crafting"},{default:(0,n.w5)((()=>[(0,n.Wm)(F,{class:"row items-start justfy-center"},{default:(0,n.w5)((()=>[(0,n._)("div",i,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.canCombineGems,(t=>((0,n.wg)(),(0,n.iD)("div",{key:t},[(0,n._)("div",{class:"gem-box row items-center justify-evenly",onClick:l=>e.setToCombine(t,0)},[(0,n.Wm)(Z,{nft:0,level:t.level,color:t.color,quality:100,scale:.64,size:50},null,8,["level","color","scale"])],8,r),(0,n._)("div",c," x "+(0,a.zw)(t.text),1)])))),128))])])),_:1}),(0,n.Wm)(F,{class:"row items-center justify-evenly"},{default:(0,n.w5)((()=>[u,m,(0,n._)("div",d,[e.fromGem1?((0,n.wg)(),(0,n.iD)("div",{key:e.fromGem1},[(0,n.Wm)(Z,{nft:e.fromGem1.nft,level:e.fromGem1.level,color:e.fromGem1.color,quality:e.fromGem1.quality,scale:e.fromGem1.scale,size:50,detail:!0},null,8,["nft","level","color","quality","scale"])])):(0,n.kq)("",!0),e.fromGem1?((0,n.wg)(),(0,n.iD)("div",v,"#"+(0,a.zw)(e.fromGem1.nft),1)):(0,n.kq)("",!0),e.fromGem1&&e.fromGems.length>2?((0,n.wg)(),(0,n.iD)("div",{key:2,class:"choose-from-gem text-center no-padding",onClick:t[0]||(t[0]=t=>{e.chooseFrom=!0,e.chooseNum=1})},p)):(0,n.kq)("",!0)]),y,(0,n._)("div",g,[e.fromGem2?((0,n.wg)(),(0,n.iD)("div",{key:e.fromGem2},[(0,n.Wm)(Z,{nft:e.fromGem2.nft,level:e.fromGem2.level,color:e.fromGem2.color,quality:e.fromGem2.quality,scale:e.fromGem2.scale,size:50,detail:!0},null,8,["nft","level","color","quality","scale"])])):(0,n.kq)("",!0),e.fromGem2?((0,n.wg)(),(0,n.iD)("div",w,"#"+(0,a.zw)(e.fromGem2.nft),1)):(0,n.kq)("",!0),e.fromGem2&&e.fromGems.length>2?((0,n.wg)(),(0,n.iD)("div",{key:2,class:"choose-from-gem text-center",onClick:t[1]||(t[1]=t=>{e.chooseFrom=!0,e.chooseNum=2})},b)):(0,n.kq)("",!0)]),x,_])),_:1}),k,(0,n.Wm)(F,{class:"row items-center justify-evenly"},{default:(0,n.w5)((()=>[(0,n._)("div",null,[(0,n._)("div",G,[e.toCombineGem?((0,n.wg)(),(0,n.j4)(Z,{key:e.toCombineGem,nft:0,level:e.toCombineGem.level,color:e.toCombineGem.color,quality:100,scale:.8,size:50},null,8,["level","color","scale"])):(0,n.kq)("",!0)]),e.toCombineGem?((0,n.wg)(),(0,n.iD)("div",{key:0,class:"info",style:{"text-shadow":"#000 1px 0 10px",position:"absolute",transform:"translate(0%, -50%)",top:"50%",right:"50%","padding-right":"35px"},onClick:t[2]||(t[2]=t=>e.updateTree(!1))},[(0,n._)("div",{class:(0,a.C_)(e.getRarity(e.toCombineGem.level).rarity+" text-h6 text-right")},(0,a.zw)(e.$t("gems.levels."+e.toCombineGem.level)+e.$t("gems.names."+e.toCombineGem.color)),3),(0,n._)("div",{class:(0,a.C_)(e.getRarity(e.toCombineGem.level).rarity+" text-right")},(0,a.zw)(e.$t("gems."+e.getRarity(e.toCombineGem.level).rarity)+" "+e.$t("gems.gem")),3)])):(0,n.kq)("",!0),e.toCombineGem?((0,n.wg)(),(0,n.iD)("div",q,[(0,n._)("div",C,[(0,n._)("div",I,(0,a.zw)(e.$t("crafting.successRate")+":"),1),(0,n._)("div",T,(0,a.zw)((((e.fromGem1?e.fromGem1.quality:0)+(e.fromGem2?e.fromGem2.quality:0)+300)/5).toFixed(2))+" % ",1)])])):(0,n.kq)("",!0)])])),_:1}),(0,n._)("div",W,(0,a.zw)(e.$t("crafting.successInfo")),1),S,(0,n.Wm)(F,null,{default:(0,n.w5)((()=>[(0,n.Wm)(ne,{unelevated:"",color:"primary",class:"min-width-320 full-width","no-caps":"",onClick:t[3]||(t[3]=t=>e.combineClicked())},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(e.$t("crafting.combine")),1)])),_:1})])),_:1}),(0,n.Wm)(F,null,{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.allCombined.slice(0,e.allCombinedNum),((t,l)=>((0,n.wg)(),(0,n.j4)(De,{dense:"",key:t},{default:(0,n.w5)((()=>[l>0?((0,n.wg)(),(0,n.j4)(Te,{key:0,spaced:"5px",inset:""})):(0,n.kq)("",!0),(0,n.Wm)(ze,null,{default:(0,n.w5)((()=>[(0,n.Wm)(Se,null,{default:(0,n.w5)((()=>[(0,n._)("div",z,[(0,n._)("div",null,[(0,n.Wm)(Z,{nft:0,level:t.fromLevel,color:t.color,quality:100,scale:.5,size:40},null,8,["level","color","scale"]),(0,n._)("div",D,(0,a.zw)("#"+t.from1),1)]),N,(0,n._)("div",null,[(0,n.Wm)(Z,{nft:0,level:t.fromLevel,color:t.color,quality:100,scale:.5,size:40},null,8,["level","color","scale"]),(0,n._)("div",H,(0,a.zw)("#"+t.from2),1)]),L,t.toLevel>=0?((0,n.wg)(),(0,n.iD)("div",R,[(0,n.Wm)(Z,{nft:t.gemId,level:t.toLevel,color:t.color,quality:e.uriToNum(t.uri).quality,scale:e.uriToNum(t.uri).scale,size:40,detail:!0},null,8,["nft","level","color","quality","scale"]),(0,n._)("div",A,"#"+(0,a.zw)(t.gemId),1)])):((0,n.wg)(),(0,n.iD)("div",U,$)),t.toLevel>=0?((0,n.wg)(),(0,n.j4)(We,{key:2,style:{top:"0px",right:"10%"},align:"top",color:"orange",floating:"",transparent:""},{default:(0,n.w5)((()=>[(0,n.Uk)((0,a.zw)(t.toLevel>t.fromLevel?e.$t("gems.success"):e.$t("gems.failed"))+"! ",1)])),_:2},1024)):(0,n.kq)("",!0)])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),(0,n.Wm)(F,null,{default:(0,n.w5)((()=>[(0,n.Wm)(ne,{unelevated:"",dense:"",flat:"",color:"primary",class:"min-width-320 full-width","no-caps":"",onClick:t[4]||(t[4]=t=>e.setAllCombinedNum(e.allCombinedNum<e.allCombined.length))},{default:(0,n.w5)((()=>[e.allCombinedNum<e.allCombined.length?((0,n.wg)(),(0,n.j4)(Ne,{key:0,name:"las la-ellipsis-h"})):((0,n.wg)(),(0,n.j4)(Ne,{key:1,name:"las la-times-circle"}))])),_:1})])),_:1})])),_:1})])),_:1})]),(0,n.Wm)(Re),(0,n.Wm)(je,{modelValue:e.switchNet,"onUpdate:modelValue":t[6]||(t[6]=t=>e.switchNet=t),persistent:""},{default:(0,n.w5)((()=>[(0,n.Wm)($e,{class:"bg-glass"},{default:(0,n.w5)((()=>[(0,n.Wm)(F,{class:"row items-center q-pb-none"},{default:(0,n.w5)((()=>[(0,n.Wm)(Ae,{icon:"signal_wifi_off",color:"primary","text-color":"white",size:"xs"}),j,(0,n.Wm)(Ue),(0,n.wy)((0,n.Wm)(ne,{icon:"close",flat:"",round:"",dense:""},null,512),[[Fe]])])),_:1}),(0,n.Wm)(F,{class:"row items-center"},{default:(0,n.w5)((()=>[E])),_:1}),(0,n.Wm)(Ze,{align:"right"},{default:(0,n.w5)((()=>[(0,n.wy)((0,n.Wm)(ne,{class:"full-width",label:"Switch",color:"primary",onClick:t[5]||(t[5]=t=>e.switchNetwork(e.netIndex))},null,512),[[Fe]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,n.Wm)(je,{modelValue:e.chooseFrom,"onUpdate:modelValue":t[7]||(t[7]=t=>e.chooseFrom=t)},{default:(0,n.w5)((()=>[(0,n.Wm)($e,{class:"bg-glass min-width-320"},{default:(0,n.w5)((()=>[(0,n.Wm)(F,{class:"row items-center q-pb-none"},{default:(0,n.w5)((()=>[(0,n._)("div",Q,[(0,n._)("div",V,(0,a.zw)(e.$t("crafting.chooseA"))+"Â ",1),(0,n._)("div",{class:(0,a.C_)(e.getRarity(e.fromGems[0].level).rarity+" text-h6")}," ["+(0,a.zw)(e.$t("gems.levels."+e.fromGems[0].level)+e.$t("gems.names."+e.fromGems[0].color))+"] ",3)])])),_:1}),(0,n.Wm)(F,{class:"row items-center q-pb-none"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.fromGems,(t=>((0,n.wg)(),(0,n.iD)("div",{class:"row",key:t},[t.nft!=e.fromGem1.nft&&t.nft!=e.fromGem2.nft?((0,n.wg)(),(0,n.iD)("div",P,[(0,n._)("div",null,[(0,n.Wm)(Z,{nft:t.nft,level:t.level,color:t.color,quality:t.quality,scale:t.scale,size:50,detail:!0},null,8,["nft","level","color","quality","scale"])]),(0,n._)("div",M,"#"+(0,a.zw)(t.nft),1),(0,n._)("div",{class:"choose-from-gem text-center",onClick:l=>e.setToCombine(t,e.chooseNum)},B,8,O)])):(0,n.kq)("",!0)])))),128))])),_:1}),(0,n.Wm)(F,{class:"row items-center q-pb-none"},{default:(0,n.w5)((()=>[J])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,n.Wm)(je,{modelValue:e.chooseTar,"onUpdate:modelValue":t[8]||(t[8]=t=>e.chooseTar=t)},{default:(0,n.w5)((()=>[(0,n.Wm)($e,{class:"bg-glass min-width-320"},{default:(0,n.w5)((()=>[(0,n.Wm)(F,{class:"row items-center q-pb-none"},{default:(0,n.w5)((()=>[K])),_:1}),(0,n.Wm)(F,{class:"row items-center q-pb-none"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.canCombineGems,(t=>((0,n.wg)(),(0,n.iD)("div",{key:t},[(0,n._)("div",{class:"gem-box row items-center justify-evenly",onClick:l=>e.setToCombine(t,0)},[(0,n.Wm)(Z,{nft:0,level:t.level,color:t.color,quality:100,scale:.64,size:45},null,8,["level","color","scale"])],8,Y),(0,n._)("div",X,"x "+(0,a.zw)(t.text),1)])))),128))])),_:1}),(0,n.Wm)(F,{class:"row items-center q-pb-none"})])),_:1})])),_:1},8,["modelValue"]),(0,n.Wm)(je,{modelValue:e.signTx,"onUpdate:modelValue":t[11]||(t[11]=t=>e.signTx=t),position:"top"},{default:(0,n.w5)((()=>[(0,n.Wm)($e,{style:{top:"50px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(F,{class:"q-pa-xs row items-center q-pb-none"},{default:(0,n.w5)((()=>[ee,(0,n.Wm)(Ue),(0,n.wy)((0,n.Wm)(ne,{icon:"close",flat:"",round:"",dense:""},null,512),[[Fe]])])),_:1}),(0,n.Wm)(F,{class:"row items-center q-pa-xs"},{default:(0,n.w5)((()=>[(0,n._)("div",te,[(0,n.Wm)(Pe,{modelValue:e.txStep,"onUpdate:modelValue":t[10]||(t[10]=t=>e.txStep=t),vertical:"",color:"primary",flat:"",animated:""},{default:(0,n.w5)((()=>[(0,n.Wm)(Ee,{name:1,title:"Sign Transaction",icon:"las la-wallet",done:e.txStep>1,error:e.signTxErr.length>0},{default:(0,n.w5)((()=>[""==e.signTxErr?((0,n.wg)(),(0,n.iD)("div",le,ae)):((0,n.wg)(),(0,n.iD)("div",se,(0,a.zw)(e.signTxErr),1))])),_:1},8,["done","error"]),(0,n.Wm)(Ee,{name:2,title:"Send Transaction",icon:"las la-receipt",done:e.txStep>2},{default:(0,n.w5)((()=>[(0,n._)("a",{href:e.linkAddress(e.signTxHash,e.netIndex,"tx"),target:"_blank",class:"text-grey-6"},[(0,n._)("span",ie,(0,a.zw)(" tx hash: "+e.shortAddress(e.signTxHash,6,!1)),1)],8,oe),re,(0,n.Wm)(Qe,{dark:"",rounded:"",indeterminate:"",color:"secondary",class:"q-mt-sm"})])),_:1},8,["done"]),(0,n.Wm)(Ee,{name:3,title:"Waiting for Result",icon:"las la-hourglass-half",done:e.txStep>3},{default:(0,n.w5)((()=>[(0,n._)("div",ce,[ue,(0,n._)("div",me,[(0,n._)("div",de,(0,a.zw)(e.$t("gems.gem")+":")+" #"+(0,a.zw)(e.txGem),1),(0,n._)("div",ve,(0,a.zw)(e.$t("gems.level")+":")+" ?? ",1),(0,n._)("div",fe,(0,a.zw)(e.$t("gems.weight")+":")+" ?? ",1),(0,n._)("div",pe,(0,a.zw)(e.$t("gems.quality")+":")+" ?? ",1)])]),(0,n.Wm)(Qe,{dark:"",rounded:"",indeterminate:"",color:"secondary",class:"q-mt-sm"}),ye,(0,n._)("a",null,[(0,n._)("span",ge,(0,a.zw)(e.$t("airdrop.whenAppear")),1)])])),_:1},8,["done"]),(0,n.Wm)(Ee,{name:4,done:4==e.txStep,title:"Result",icon:"las la-trophy"},{default:(0,n.w5)((()=>[(0,n._)("div",we,[(0,n._)("div",he,[(0,n.Wm)(Z,{nft:e.txGemDetail.nft,level:e.txGemDetail.level,color:e.txGemDetail.color,quality:e.txGemDetail.quality,scale:e.txGemDetail.scale,size:50},null,8,["nft","level","color","quality","scale"])]),(0,n._)("div",be,[(0,n._)("div",xe,(0,a.zw)(e.txGemSuccess?e.$t("gems.success"):e.$t("gems.failed"))+"! ",1),(0,n._)("div",{class:(0,a.C_)(e.getRarity(e.txGemDetail.level).rarity+" text-h6")},(0,a.zw)(e.$t("gems.levels."+e.txGemDetail.level)+e.$t("gems.names."+e.txGemDetail.color)),3),(0,n._)("div",{class:(0,a.C_)(e.getRarity(e.txGemDetail.level).rarity)},[(0,n.Uk)((0,a.zw)(e.$t("gems."+e.getRarity(e.txGemDetail.level).rarity)+" "+e.$t("gems.gem"))+" ",1),(0,n.Wm)(Ve,{dense:"",color:"grey"},{default:(0,n.w5)((()=>[(0,n._)("a",{class:(0,a.C_)(e.getRarity(e.txGemDetail.level).rarity)},(0,a.zw)(e.getRarity(e.txGemDetail.level).short),3)])),_:1})],2),(0,n._)("div",_e,[(0,n._)("div",ke,(0,a.zw)(e.$t("gems.level")+": "+(4*parseInt(e.txGemDetail.level)+10)),1),(0,n._)("div",Ge,(0,a.zw)(e.$t("gems.weight")+": "+parseInt(100*e.txGemDetail.scale)),1),(0,n._)("div",qe,(0,a.zw)(e.$t("gems.quality")+": "+e.txGemDetail.quality),1)])]),Ce,(0,n.Wm)(ne,{onClick:t[9]||(t[9]=t=>e.signTx=!1),color:"primary",label:"OK",class:"q-ml-sm full-width",dense:""})])])),_:1},8,["done"])])),_:1},8,["modelValue"])])])),_:1}),(0,n.Wm)(F,{class:"q-pa-xs row items-center q-pb-none"},{default:(0,n.w5)((()=>[Ie])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,n.Wm)(Me)])),_:1})}var We=l(60499),Se=l(19302),ze=l(65457),De=l(9229),Ne=l(17387),He=l(16898),Le=l(85990),Re=l(28488),Ae=l(88576),Ue=l.n(Ae),Ze=l(17779),$e=function(e,t,l,n){function a(e){return e instanceof l?e:new l((function(t){t(e)}))}return new(l||(l=Promise))((function(l,s){function o(e){try{r(n.next(e))}catch(t){s(t)}}function i(e){try{r(n["throw"](e))}catch(t){s(t)}}function r(e){e.done?l(e.value):a(e.value).then(o,i)}r((n=n.apply(e,t||[])).next())}))},je=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,l=e[Symbol.asyncIterator];return l?l.call(e):(e="function"===typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(l){t[l]=e[l]&&function(t){return new Promise((function(n,s){t=e[l](t),a(n,s,t.done,t.value)}))}}function a(e,t,l,n){Promise.resolve(n).then((function(t){e({value:t,done:l})}),t)}};const Ee=l(10875),Qe=l(72593);function Ve(e){Ze.log("Switch network: ",(0,Le.v)().networks[e].name,(0,Le.v)().networks[e].id),(0,Le.v)().initWeb3(e)}const Pe={title:"Crystal - Crafting"},Me=(0,n.aZ)({name:"CraftingPage",components:{NftMenu:De.Z,CrystalGem:Ne.Z,BalanceView:He.Z},setup(){const e=(0,Se.Z)();e.dark.set(!0),(0,ze.Z)(Pe);const t=(0,We.iH)(1),l=(0,We.iH)({}),a=(0,We.iH)(0),s=(0,We.iH)([]),o=(0,We.iH)([]),i=(0,We.iH)([]),r=(0,We.iH)([]),c=(0,We.iH)(),u=(0,We.iH)(),m=(0,We.iH)(),d=(0,We.iH)(!1),v=(0,We.iH)(""),f=(0,We.iH)(""),p=(0,We.iH)(1),y=(0,We.iH)(0),g=(0,We.iH)(),w=(0,We.iH)(!1);let h,b,x=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],_=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];const k=e=>new Promise((t=>setTimeout(t,e))),G=(0,We.iH)(!1),q=(0,We.iH)(!1),C=(0,We.iH)(!1),I=(0,We.iH)(0),T="polygon",W=(0,We.iH)(0),S=(0,We.iH)("0xE2956E26d7d0a8F65389d1Ec095e83475C0bdf37"),z=(0,We.iH)("0x30a8C517b35e7D635f77AaeeBb0C704015dFaa6A");let D=(0,n.Fl)((()=>{let e=[];for(var t in l.value)l.value.hasOwnProperty(t)&&e.unshift(l.value[t]);return e.slice(0,10)}));function N(){return $e(this,void 0,void 0,(function*(){const e=yield(0,Le.v)().web3.eth.net.getId().then((e=>e)).catch((e=>(Ze.log("checkNetwork: ",e),-1)));return e}))}function H(e){return $e(this,void 0,void 0,(function*(){const t=(0,Le.v)().networks[e].id,l=(0,Le.v)().networks[e].name,n=(0,Le.v)().networks[e].tokenName,a=(0,Le.v)().networks[e].symbol,s=(0,Le.v)().networks[e].rpcUrl,o=(0,Le.v)().networks[e].explorer,i="0x"+t.toString(16);if("undefined"!==typeof window.ethereum)try{yield window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:i}]}),location.reload()}catch(r){if(Ze.log(r),4902===r.code){Ze.log("Add Chain");try{yield window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:i,chainName:l,nativeCurrency:{name:n,symbol:a,decimals:18},rpcUrls:[s],blockExplorerUrls:[o]}]}),location.reload()}catch(c){alert(c.message)}}else alert(r.message)}}))}function L(e){return $e(this,void 0,void 0,(function*(){const t=yield Ue().Web3API.token.reSyncMetadata({chain:T,address:z.value,token_id:e,flag:"uri"});Ze.log("reSyncURI resp:",e,t)}))}function R(e){var t,l,n,a;return $e(this,void 0,void 0,(function*(){try{for(t=je(e);l=yield t.next(),!l.done;){const e=l.value;yield k(1e3),yield L(e),yield A(e)}}catch(s){n={error:s}}finally{try{l&&!l.done&&(a=t.return)&&(yield a.call(t))}finally{if(n)throw n.error}}}))}function A(e){return $e(this,void 0,void 0,(function*(){Ze.log("getGemURI id:",e);const t=(0,Le.v)().web3Instance,l=new t.eth.Contract(Ee,z.value);l.methods.tokenURI(e).call().then((function(t){if(!t.length)return void Ze.log("getGemURI length: ",t.length);Ze.log("getGemURI: ",t);const l=parseInt(e),n=JSON.parse(t),a=(0,Le.v)().web3.utils.toHex(n.properties);let s=10,i=10;for(let e=2;e<14;e++){const t=parseInt(a[e],16);e<8?s+=t:e<14&&(i+=t)}const r={nft:l,level:n.level,color:n.color,quality:s,scale:i/100,properties:a,text:""};for(let e=0;e<o.value.length;e++){const t=o.value[e];t.nft==l&&o.value.splice(e,1)}P(r,l)})).catch((function(e){Ze.log("getGemURI: ",e)}))}))}function U(){var e;return $e(this,void 0,void 0,(function*(){const t="https://g19udojubwks.usemoralis.com:2053/server",l="P749qSdfiW93rIsFAtUSWNAnJK4HX8hyvauadRFz";yield Ue().start({serverUrl:t,appId:l});const n=(0,Le.v)().account,a=(0,Le.v)().web3Instance;if(!a.utils.isAddress(n))return alert("Need Connect Wallet!"),void Ze.log("Not Address:",n);try{let t=yield Ue().Web3API.account.getNFTsForContract({chain:T,address:n,token_address:z.value});const l=t.result||[];while(t.next){if(t=yield t.next(),0==(null===(e=null===t||void 0===t?void 0:t.result)||void 0===e?void 0:e.length))break;l.push(...t.result||[])}O(l);let a=[];o.value=[],l.forEach((e=>{const t=parseInt(e.token_id);if(e.token_uri){const l=JSON.parse(e.token_uri),n=(0,Le.v)().web3.utils.toHex(l.properties);let a=10,s=10;for(let e=2;e<14;e++){const t=parseInt(n[e],16);e<8?a+=t:e<14&&(s+=t)}const o={nft:t,level:l.level,color:l.color,quality:a,scale:s/100,properties:n,text:""};P(o,t)}else{const l={nft:t,level:8,color:0,quality:10,scale:1,properties:"0xffffffffffff",text:""};a.push(e.token_id);let n=!1;for(let e=0;e<s.value.length;e++){const l=s.value[e];if(l.nft==t){n=!0;break}}n||(o.value.unshift(l),Ze.log(l))}})),R(a),F(!1)}catch(i){Ze.log(i)}}))}function Z(e,t){var l="0";for(let n=0;n<e.length;n++){const a=e[n];if(a.address.toUpperCase()==t.toUpperCase()){const e=(0,Le.v)().web3.eth.abi.decodeParameters([{type:"uint256",name:"color"},{type:"uint256",name:"from1"},{type:"uint256",name:"from2"},{type:"uint256",name:"fromLevel"},{type:"uint256",name:"rate"},{type:"uint256",name:"gemId"}],a.data);l=e.gemId.toString();break}}return parseInt(l)}function $(e,t){return $e(this,void 0,void 0,(function*(){if(!(0,Le.v)().web3.utils.isAddress((0,Le.v)().account))return void alert("Need Connect Wallet!");const l=W.value,n=yield N();if(n!=(0,Le.v)().networks[l].id)return Ze.log(n,"!=",(0,Le.v)().networks[l].id),void(G.value=!0);v.value="",f.value="",p.value=1,d.value=!0;const a=(0,Le.v)().web3,s=S.value,o=(0,Le.v)().account,i=new a.eth.Contract(Qe,s);let r=i.methods.combineGem(e,t),c=r.encodeABI();a.eth.estimateGas({from:o,to:s,value:0,data:c}).then((function(e){Ze.log("gasAmount: ",e),a.eth.sendTransaction({from:o,to:s,value:0,gas:parseInt((1.05*e).toString()),gasPrice:36e9,data:c}).on("transactionHash",(e=>{Ze.log("transactionHash: ",e),p.value=2,f.value=e})).on("receipt",(e=>{const t=Z(e.logs,s);Ze.log("gemId:",t),y.value=t,p.value=3,U()})).on("error",(e=>{Ze.log("tx combineGem",e),v.value=e.message,p.value=1}))})).catch((function(e){Ze.log("estimateGas: ",e);let t=e.message.toString(),l=t.split(".")[1],n=JSON.parse(l),a=n.message.split(":");v.value=a[0]+": "+a[1]}))}))}function j(){return $e(this,void 0,void 0,(function*(){const e=(0,Le.v)().account,t=(0,Le.v)().web3Instance;if(!t.utils.isAddress(e))return alert("Need Connect Wallet!"),void Ze.log("Not Address:",e);Ze.log("listenGemCombine:",e);const n=new t.eth.Contract(Qe,S.value),a={filter:{user:e},fromBlock:29827141};h=n.events.GemCombine(a).on("data",(function(e){if(!e.removed){const t=e.returnValues,n=t.gemId,a={color:parseInt(t.color),from1:parseInt(t.from1),from2:parseInt(t.from2),fromLevel:parseInt(t.fromLevel),gemId:parseInt(n),rate:parseInt(t.rate),user:t.user,success:void 0!=l.value[n]&&void 0!=l.value[n].success?l.value[n].success:"",toLevel:void 0!=l.value[n]&&void 0!=l.value[n].toLevel?l.value[n].toLevel:-1,uri:void 0!=l.value[n]&&void 0!=l.value[n].uri?l.value[n].uri:""};l.value[n]=a,M(t.from1),M(t.from2),F(!1)}})).on("changed",(function(e){Ze.log("listenGemCombine changed:",e)})).on("error",(function(e){Ze.log("listenGemCombine Err:",e)})).on("connected",(function(e){Ze.log("listenGemCombine subscription id:",e)}))}))}function E(){return $e(this,void 0,void 0,(function*(){const e=(0,Le.v)().account,t=(0,Le.v)().web3Instance;if(!t.utils.isAddress(e))return alert("Need Connect Wallet!"),void Ze.log("Not Address:",e);Ze.log("listenGemSettled:",e);const n=new t.eth.Contract(Qe,S.value),a={filter:{user:e},fromBlock:29827141};b=n.events.GemSettled(a).on("data",(function(e){return $e(this,void 0,void 0,(function*(){if(!e.removed){const t=e.returnValues,n=t.gemId,a={color:parseInt(t.color),from1:parseInt(t.from1),from2:parseInt(t.from2),gemId:parseInt(n),user:t.user,success:t.success,toLevel:parseInt(t.toLevel),uri:t.uri,rate:void 0!=l.value[n]&&void 0!=l.value[n].rate?l.value[n].rate:0,fromLevel:void 0!=l.value[n]?void 0!=l.value[n].fromLevel?l.value[n].fromLevel:"true"==t.success?parseInt(t.toLevel)-1:-1:-1};l.value[n]=a,parseInt(n)==y.value&&(g.value={nft:parseInt(n),level:parseInt(t.toLevel),color:parseInt(t.color),quality:J(t.uri).quality,scale:J(t.uri).scale,properties:"",text:""},w.value=l.value[n].toLevel>l.value[n].fromLevel,p.value=4,yield A(n),F(!1))}}))})).on("changed",(function(e){Ze.log("listenGemSettled changed:",e)})).on("error",(function(e){Ze.log("listenGemSettled Err:",e)})).on("connected",(function(e){Ze.log("listenGemSettled subscription id:",e)}))}))}function Q(){return $e(this,void 0,void 0,(function*(){const e=(0,Le.v)().account,t=(0,Le.v)().web3Instance;if(!t.utils.isAddress(e))return alert("Need Connect Wallet!"),void Ze.log("Not Address:",e);Ze.log("getAllEvents:",e);const n=new t.eth.Contract(Qe,S.value),a={filter:{user:e},fromBlock:29827141,toBlock:"latest"};n.getPastEvents("GemSettled",a).then((function(e){Ze.log("GemSettled:",e),e.forEach((e=>{if(e.removed)Ze.log("event.removed: ",e);else{const t=e.returnValues,n=t.gemId,a={color:parseInt(t.color),from1:parseInt(t.from1),from2:parseInt(t.from2),gemId:parseInt(n),user:t.user,success:t.success,toLevel:parseInt(t.toLevel),uri:t.uri,rate:void 0!=l.value[n]?l.value[n].rate:0,fromLevel:void 0!=l.value[n]?l.value[n].fromLevel:"true"==t.success?parseInt(t.toLevel)-1:-1};l.value[n]=a}}))})).catch((function(e){Ze.log("getAllEvents Err: ",e)}))}))}function V(){h&&h.unsubscribe(),b&&b.unsubscribe()}function P(e,t){let l=!1;for(let n=0;n<s.value.length;n++){const e=s.value[n];if(e.nft==t){l=!0;break}}l||(s.value.unshift(e),Ze.log(e))}function M(e){for(let t=0;t<s.value.length;t++){const l=s.value[t];if(l.nft==e){s.value.splice(t,1);break}}}function O(e){let t=[];for(let l=0;l<s.value.length;l++){const n=s.value[l];for(let l=0;l<e.length;l++){const a=e[l].token_id;a==n.nft&&t.push(n)}}s.value=t,F(!1)}function F(e){c.value=void 0,u.value=void 0,m.value=void 0;for(let l=0;l<6;l++)for(let e=0;e<16;e++)x[l][e]=0;for(let l=0;l<s.value.length;l++){const e=s.value[l],t=e.color,n=e.level;x[t][n]+=1}let t=[];for(let l=0;l<6;l++)for(let e=0;e<15;e++)if(x[l][e]>=2){const n=Math.floor(x[l][e]/2);_[l][e+1]=n;const a={nft:0,level:e+1,color:l,quality:100,scale:1,properties:"0xffffffffffff",text:n.toString()};t.push(a)}i.value=t}function B(e,t){switch(t){case 0:m.value=e,r.value=[];for(let t=0;t<s.value.length;t++){const l=s.value[t];l.color==e.color&&l.level+1==e.level&&r.value.push(l)}r.value.sort((function(e,t){return e.quality<t.quality?1:e.quality>t.quality?-1:0})),c.value=r.value[0],u.value=r.value[1];break;case 1:c.value=e;break;case 2:u.value=e;break;default:Ze.log("default");break}q.value=!1,C.value=!1}function J(e){const t=JSON.parse(e),l=(0,Le.v)().web3.utils.toHex(t.properties);let n=10,a=10;for(let s=2;s<14;s++){const e=parseInt(l[s],16);s<8?n+=e:s<14&&(a+=e)}return{quality:n,scale:a/100}}function K(){Ze.log(l.value["7600"])}let Y={};for(let n=0;n<101;n++)Y[n.toString()]=0;return{test:K,shortAddress:Re.sC,copyAddress:Re.c4,linkAddress:Re.ol,uriToNum:J,listenerGemCombine:h,listenerGemSettled:b,signTx:d,signTxErr:v,signTxHash:f,txStep:p,txGem:y,txGemDetail:g,txGemSuccess:w,gemNftContract:z,combineContract:S,netIndex:W,chain:T,switchNet:G,chooseTar:q,chooseFrom:C,chooseNum:I,userGems:s,newGems:o,canCombineGems:i,fromGems:r,fromGem1:c,fromGem2:u,toCombineGem:m,gemTree:x,combineTree:_,combineEvents:l,updateEvents:a,allCombined:D,allCombinedNum:t,checkNetwork:N,switchNetwork:H,getUserGems:U,combineGemTx:$,listenGemCombine:j,listenGemSettled:E,getAllEvents:Q,updateTree:F,setToCombine:B,removeListeners:V,setAllCombinedNum(e=!0){e?t.value++:t.value=1},initGame(){return $e(this,void 0,void 0,(function*(){let e=new URLSearchParams(window.location.search),t=e.get("ref");Ze.log(t||"No Ref");const l=W.value;Ve(l);const n=yield N();if(n!=(0,Le.v)().networks[l].id)return Ze.log(n,"!=",(0,Le.v)().networks[l].id),void(G.value=!0);j(),E()}))},combineClicked(){return $e(this,void 0,void 0,(function*(){void 0!=c.value&&void 0!=u.value&&c.value.level==u.value.level&&c.value.color==u.value.color&&(Ze.log("Combine Gems: ",c.value.nft,u.value.nft),$(c.value.nft,u.value.nft),c.value=void 0,u.value=void 0,m.value=void 0)}))},getRarity(e){let t="Common",l="C";switch(e){case 4:case 5:case 6:case 7:l="UC";break;case 8:case 9:l="R";break;case 10:l="RR";break;case 11:l="RRR";break;case 12:l="SR";break;case 13:l="HR";break;case 14:l="UR";break;case 15:l="SSR";break;default:break}switch(e){case 4:case 5:case 6:case 7:t="Uncommon";break;case 8:case 9:case 10:case 11:t="Rare";break;case 12:case 13:case 14:case 15:t="Epic";break;default:break}return{rarity:t,short:l}},initDate(){localStorage.getItem((0,Le.v)().account.concat("-userGems"))&&Object.assign(s.value,JSON.parse(localStorage.getItem((0,Le.v)().account.concat("-userGems"))||""))},storeData(){Ze.log("storeData: userGems"),localStorage.setItem((0,Le.v)().account.concat("-userGems"),JSON.stringify(s.value))}}},beforeMount(){this.initDate(),this.initGame(),this.getUserGems(),this.updateTree(!1)},beforeUnmount(){this.removeListeners(),this.storeData()}});var Oe=l(11639),Fe=l(69885),Be=l(89800),Je=l(84106),Ke=l(63190),Ye=l(57691),Xe=l(68879),et=l(13246),tt=l(50926),lt=l(490),nt=l(76749),at=l(20990),st=l(22857),ot=l(32074),it=l(44458),rt=l(61357),ct=l(90136),ut=l(11821),mt=l(8225),dt=l(46017),vt=l(21992),ft=l(8289),pt=l(62146),yt=l(69984),gt=l.n(yt);const wt=(0,Oe.Z)(Me,[["render",Te],["__scopeId","data-v-8a55edfa"]]),ht=wt;gt()(Me,"components",{QPage:Fe.Z,QTabPanels:Be.Z,QTabPanel:Je.Z,QCardSection:Ke.Z,QChip:Ye.Z,QBtn:Xe.Z,QList:et.Z,QSeparator:tt.Z,QItem:lt.Z,QItemSection:nt.Z,QBadge:at.Z,QIcon:st.Z,QDialog:ot.Z,QCard:it.Z,QAvatar:rt.Z,QSpace:ct.Z,QCardActions:ut.Z,QStepper:mt.Z,QStep:dt.Z,QStepperNavigation:vt.Z,QLinearProgress:ft.Z}),gt()(Me,"directives",{ClosePopup:pt.Z})},72593:e=>{e.exports=JSON.parse('[{"inputs":[{"internalType":"address","name":"gem","type":"address"},{"internalType":"address","name":"rand","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"newGame","type":"address"}],"name":"GameAdded","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"removedGame","type":"address"}],"name":"GameRemoved","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"color","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"from1","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"from2","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"fromLevel","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"rate","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"gemId","type":"uint256"}],"name":"GemCombine","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"color","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"from1","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"from2","type":"uint256"},{"indexed":false,"internalType":"bool","name":"success","type":"bool"},{"indexed":false,"internalType":"uint256","name":"gemId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"toLevel","type":"uint256"},{"indexed":false,"internalType":"string","name":"uri","type":"string"}],"name":"GemSettled","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"inputs":[{"internalType":"address","name":"newGame","type":"address"}],"name":"addGame","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"gem1","type":"uint256"},{"internalType":"uint256","name":"gem2","type":"uint256"}],"name":"combineGem","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"games","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"who","type":"address"}],"name":"isGame","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"game","type":"address"}],"name":"removeGame","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_contract","type":"address"}],"name":"setGem","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"requestId","type":"bytes32"},{"internalType":"uint256","name":"randomness","type":"uint256"}],"name":"settleRand","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"toggleGameIsLive","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"}]')}}]);